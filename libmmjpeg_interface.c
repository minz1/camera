/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __fastcall _cxa_finalize(_DWORD); weak
// int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *mutexattr);
// void *malloc(size_t size);
// int _android_log_print(_DWORD, _DWORD, const char *, ...); weak
// void *memset(void *s, int c, size_t n);
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
// void free(void *ptr);
int __fastcall j_mm_jpeg_queue_flush(int a1);
// int pthread_mutex_destroy(pthread_mutex_t *mutex);
// void *memcpy(void *dest, const void *src, size_t n);
int __fastcall j_addExifEntry(int, int, int, size_t size, int); // idb
// int pthread_cond_signal(pthread_cond_t *cond);
// int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex);
// int pthread_cond_init(pthread_cond_t *cond, const pthread_condattr_t *cond_attr);
// int __fastcall OMX_GetHandle(_DWORD, _DWORD, _DWORD); weak
int __fastcall j_releaseExifEntry(int a1);
int __fastcall j_mm_jpeg_session_change_state(int a1, int a2, int (__fastcall *a3)(_DWORD), int a4);
int __fastcall j_mm_jpeg_release_exif(int a1, int a2, int a3);
// int __fastcall OMX_FreeHandle(_DWORD); weak
// int pthread_cond_destroy(pthread_cond_t *cond);
signed int __fastcall j_map_jpeg_format(int a1, int a2, int a3);
int __fastcall j_mm_jpeg_session_config_ports(int a1);
int __fastcall j_mm_jpeg_session_config_main_buffer_offset(int a1);
int __fastcall j_mm_jpeg_encoding_mode(int a1);
int __fastcall j_processAAAInfo(int a1, int a2, int a3);
int __fastcall j_process_meta_data(int a1, int a2, int a3);
int __fastcall j_mm_jpeg_queue_init(int a1);
// int pthread_create(pthread_t *newthread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);
signed int __fastcall j_mm_jpeg_queue_enq(int a1, int a2);
// int pthread_join(pthread_t th, void **thread_return);
int __fastcall j_mm_jpeg_queue_deinit(int a1);
int __fastcall j_mm_jpeg_jobmgr_thread_launch(int a1);
void *__fastcall j_buffer_allocate(int a1, int a2);
signed int __fastcall j_mm_jpeg_jobmgr_thread_release(int a1, int a2, int a3, int a4);
// int __cdecl OMX_Init(_DWORD, _DWORD); weak
int __fastcall j_buffer_deallocate(int a1, int a2, int a3);
// int __fastcall OMX_Deinit(_DWORD); weak
int __fastcall j_mm_jpeg_util_generate_handler(int a1);
int __fastcall j_mm_jpeg_util_get_index_by_handler(int result);
int __fastcall j_mm_jpeg_session_create(int a1);
int __fastcall j_mm_jpeg_queue_remove_job_by_session_id(int a1, int a2, int a3);
int __fastcall j_mm_jpeg_session_abort(int a1);
int __fastcall j_mm_jpeg_session_destroy(int a1, int a2, int a3, int a4);
int __fastcall j_mm_jpeg_destroy_session(int a1, int a2);
signed int __fastcall j_mm_jpeg_destroy_session_unlocked(int a1, int a2, int a3);
int __fastcall j_mm_jpeg_queue_remove_job_by_job_id(int a1, int a2);
int __fastcall j_mm_jpeg_session_config_main(int a1, int a2, int a3, int a4);
int __fastcall j_mm_jpeg_session_config_common(int a1);
signed int __fastcall j_mm_jpeg_session_config_main_crop(int a1);
signed int __fastcall j_mm_jpeg_session_config_thumbnail(int a1);
int __fastcall j_mm_jpeg_metadata(int a1);
// int __fastcall _errno(_DWORD); weak
// char *strerror(int errnum);
int __fastcall j_mm_jpeg_queue_get_size(int a1);
int __fastcall j_mm_jpeg_queue_deq(int a1);
signed int __fastcall j_mm_jpeg_process_encoding_job(int a1, int a2, int a3);
signed int __fastcall j_mm_jpeg_close(int a1, int a2, int a3);
int __fastcall j_mm_jpeg_deinit(int a1, int a2, int a3, int a4);
int __fastcall j_mm_jpeg_destroy_session_by_id(int a1, unsigned __int16 a2, int a3);
int __fastcall j_mm_jpeg_create_session(int a1, int a2, int a3, unsigned int *a4);
signed int __fastcall j_mm_jpeg_abort_job(int a1, int a2, int a3);
signed int __fastcall j_mm_jpeg_start_job(int a1, int a2, int *a3);
int __fastcall j_mm_jpeg_init(int a1, int a2);
int __fastcall j_mm_jpeg_new_client(char *a1);
// int open(const char *file, int oflag, ...);
// int ioctl(int fd, unsigned __int32 request, ...);
// void *mmap(void *addr, size_t len, int prot, int flags, int fd, __off_t offset);
// int munmap(void *addr, size_t len);
// int close(int fd);
// void abort(void);
// int fprintf(FILE *stream, const char *format, ...);
// int __fastcall _aeabi_memcpy(_DWORD); weak
// int __fastcall _aeabi_memset(_DWORD, _DWORD, _DWORD); weak
// int dladdr(void); weak
// int __fastcall _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD); weak
int j___aeabi_ldiv0();
// int raise(int sig);
int sub_1A24();
int (*__fastcall sub_1A44(int (*result)(void)))(void);
int __fastcall mm_jpeg_queue_init(int a1);
signed int __fastcall mm_jpeg_queue_enq(int a1, int a2);
int __fastcall mm_jpeg_queue_deq(int a1);
int __fastcall mm_jpeg_queue_get_size(int a1);
int __fastcall mm_jpeg_queue_flush(int a1);
int __fastcall mm_jpeg_queue_deinit(int a1);
int __fastcall mm_jpeg_queue_peek(int a1);
int __fastcall addExifEntry(int, int, int, size_t size, int); // idb
int __fastcall releaseExifEntry(int a1);
int __fastcall processAAAInfo(int a1, int a2, int a3);
int __fastcall process_meta_data(int a1, int a2, int a3);
int __fastcall mm_jpeg_session_free_buffers(int a1, int a2, int a3);
int __fastcall mm_jpeg_ebd(int a1, int a2);
int __fastcall sub_2424(int a1);
int __fastcall mm_jpeg_session_send_buffers(int a1);
int __fastcall mm_jpeg_session_change_state(int a1, int a2, int (__fastcall *a3)(_DWORD), int a4);
int __fastcall mm_jpeg_session_create(int a1);
int __fastcall mm_jpeg_release_exif(int a1, int a2, int a3);
int __fastcall mm_jpeg_session_destroy(int a1, int a2, int a3, int a4);
int __fastcall mm_jpeg_session_config_main_buffer_offset(int a1);
int __fastcall mm_jpeg_encoding_mode(int a1);
signed int __fastcall map_jpeg_format(int a1, int a2, int a3);
int __fastcall mm_jpeg_session_config_ports(int a1);
signed int __fastcall mm_jpeg_session_config_thumbnail(int a1);
signed int __fastcall mm_jpeg_session_config_main_crop(int a1);
int __fastcall mm_jpeg_session_config_main(int a1, int a2, int a3, int a4);
int __fastcall mm_jpeg_session_config_common(int a1);
int __fastcall mm_jpeg_session_abort(int a1);
signed int __fastcall mm_jpeg_get_new_session_idx(int a1, int a2, _DWORD *a3);
int __fastcall mm_jpeg_remove_session_idx(int a1, unsigned __int16 a2);
int __fastcall mm_jpeg_get_session(int a1, unsigned __int16 a2, int a3);
int __fastcall mm_jpeg_metadata(int a1);
int __fastcall mm_jpeg_jobmgr_thread_launch(int a1);
signed int __fastcall mm_jpeg_jobmgr_thread_release(int a1, int a2, int a3, int a4);
int __fastcall mm_jpeg_init(int a1, int a2);
int __fastcall mm_jpeg_deinit(int a1, int a2, int a3, int a4);
int __fastcall mm_jpeg_new_client(char *a1);
signed int __fastcall mm_jpeg_start_job(int a1, int a2, int *a3);
int __fastcall mm_jpeg_create_session(int a1, int a2, int a3, unsigned int *a4);
int __fastcall mm_jpeg_queue_remove_job_by_client_id(int a1, int a2, int a3);
int __fastcall mm_jpeg_queue_remove_job_by_session_id(int a1, int a2, int a3);
int __fastcall mm_jpeg_destroy_session(int a1, int a2);
int __fastcall mm_jpeg_destroy_session_by_id(int a1, unsigned __int16 a2, int a3);
signed int __fastcall mm_jpeg_destroy_session_unlocked(int a1, int a2, int a3);
signed int __fastcall mm_jpeg_close(int a1, int a2, int a3);
int __fastcall mm_jpeg_queue_remove_job_by_job_id(int a1, int a2);
int __fastcall sub_3F38(int a1);
signed int __fastcall mm_jpeg_process_encoding_job(int a1, int a2, int a3);
int __fastcall sub_4478(int a1, int a2);
int __fastcall mm_jpeg_fbd(int a1, int a2, int a3);
int __fastcall mm_jpeg_event_handler(int a1, int a2, int a3);
signed int __fastcall mm_jpeg_abort_job(int a1, int a2, int a3);
int __fastcall mm_jpeg_queue_remove_job_unlk(int a1, int a2);
signed int __fastcall sub_4734(int a1, int a2);
signed int __fastcall sub_47E0(int a1, int a2, int a3);
signed int __fastcall sub_4868(int a1, int a2, unsigned int *a3);
signed int __fastcall sub_48FC(int a1, int a2, int a3);
signed int __fastcall sub_4984(int a1, int *a2);
int __fastcall mm_jpeg_util_generate_handler(int a1);
int __fastcall mm_jpeg_util_get_index_by_handler(int result);
void *__fastcall jpeg_open(int a1, int a2);
void *__fastcall buffer_allocate(int a1, int a2);
int __fastcall buffer_deallocate(int a1, int a2, int a3);
signed int __fastcall sub_4D14(int a1, int a2, unsigned int a3, unsigned int a4);
signed int __fastcall sub_5054(int a1, int a2, unsigned int a3, int a4, int *a5);
signed int __fastcall sub_50F8(int a1, int a2, unsigned int a3, int a4);
signed int __fastcall sub_5220(int a1, int a2, int a3);
void sub_5274();
void sub_527C();
signed int __fastcall sub_5318(int a1, int a2, char a3);
void __fastcall sub_5434(int a1, int a2, int a3);
int __fastcall sub_54B8(int a1, int a2, int a3, int a4, int a5);
int __fastcall sub_54D0(int _R0);
int __fastcall sub_54D8(int _R0);
int __fastcall sub_54E0(int _R0);
void sub_54E8();
void sub_552C();
int __fastcall sub_5540(int a1);
signed int __fastcall sub_5590(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_55C0(int a1, int a2, int a3);
signed int __fastcall sub_5604(int a1, int a2, _QWORD *a3);
signed int __fastcall sub_5634(int a1, int a2, int a3, int a4);
int __fastcall sub_566C(int a1);
signed int __fastcall sub_5674(int a1, int a2);
signed int __fastcall sub_5694(int a1);
int __fastcall sub_56AC(int a1);
int __fastcall sub_56BC(int a1, int a2);
int __fastcall sub_56DC(int a1, signed int a2);
int __fastcall sub_5778(int result, signed int a2, int a3);
int __fastcall sub_5810(int a1, int a2);
__int64 __fastcall sub_5830(int a1, int a2);
int __fastcall sub_58E0(int a1, int a2, int a3, int a4);
signed int __fastcall sub_59B4(int a1);
int __fastcall sub_5A00(int a1, int a2);
void __fastcall sub_5A38(int a1);
int __fastcall sub_5A50(int a1);
signed int __fastcall sub_5A58(int a1, int a2, int a3, _DWORD *a4);
int __fastcall sub_5AB4(int a1, int a2);
const char *__fastcall sub_5B04(int a1, signed int a2);
int __fastcall sub_5B0C(int result);
void __fastcall sub_5B14(int a1, int a2, int a3, int a4);
int __fastcall sub_5B48(int a1);
int sub_5B9C(); // weak
int __fastcall sub_5D24(int result, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8);
int sub_63F8(); // weak
int __fastcall sub_640C(int _R0);
int __fastcall sub_6414(int _R0);
int __fastcall sub_641C(int _R0);
int __fastcall sub_6424(_DWORD *a1);
int __fastcall sub_6468(_DWORD *a1);
int __fastcall sub_6484(int result, unsigned int a2);
int _aeabi_ldiv0();
int j_j_pthread_mutex_unlock(pthread_mutex_t *mutex);
int j_pthread_mutex_unlock(pthread_mutex_t *mutex);
int __fastcall j_j_j_mm_jpeg_destroy_session(int a1, int a2);
int __fastcall j_j_mm_jpeg_destroy_session(int a1, int a2);
void sub_65A8();
void sub_65AC();
int __fastcall sub_65B8(_DWORD *a1);
int __fastcall sub_65BC(_DWORD *a1);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_5228; // weak
void *off_9D24 = (void *)0x56B5; // weak
int GLOBAL_OFFSET_TABLE_ = 0; // weak
void *off_A000 = &off_A000; // weak
_UNKNOWN unk_A004; // weak
__int16 word_A008; // weak
int dword_A00C; // weak
_UNKNOWN unk_A010; // weak
_UNKNOWN unk_A014; // weak
// extern struct _IO_FILE *stderr;


//----- (000016C4) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_flush(int a1)
{
  return mm_jpeg_queue_flush(a1);
}

//----- (000016E8) --------------------------------------------------------
int __fastcall j_addExifEntry(int a1, int a2, int a3, size_t size, int a5)
{
  return addExifEntry(a1, a2, a3, size, a5);
}

//----- (00001724) --------------------------------------------------------
int __fastcall j_releaseExifEntry(int a1)
{
  return releaseExifEntry(a1);
}

//----- (00001730) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_change_state(int a1, int a2, int (__fastcall *a3)(_DWORD), int a4)
{
  return mm_jpeg_session_change_state(a1, a2, a3, a4);
}

//----- (0000173C) --------------------------------------------------------
int __fastcall j_mm_jpeg_release_exif(int a1, int a2, int a3)
{
  return mm_jpeg_release_exif(a1, a2, a3);
}

//----- (00001760) --------------------------------------------------------
signed int __fastcall j_map_jpeg_format(int a1, int a2, int a3)
{
  return map_jpeg_format(a1, a2, a3);
}

//----- (0000176C) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_config_ports(int a1)
{
  return mm_jpeg_session_config_ports(a1);
}

//----- (00001778) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_config_main_buffer_offset(int a1)
{
  return mm_jpeg_session_config_main_buffer_offset(a1);
}

//----- (00001784) --------------------------------------------------------
int __fastcall j_mm_jpeg_encoding_mode(int a1)
{
  return mm_jpeg_encoding_mode(a1);
}

//----- (00001790) --------------------------------------------------------
int __fastcall j_processAAAInfo(int a1, int a2, int a3)
{
  return processAAAInfo(a1, a2, a3);
}

//----- (0000179C) --------------------------------------------------------
int __fastcall j_process_meta_data(int a1, int a2, int a3)
{
  return process_meta_data(a1, a2, a3);
}

//----- (000017A8) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_init(int a1)
{
  return mm_jpeg_queue_init(a1);
}

//----- (000017C0) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_queue_enq(int a1, int a2)
{
  return mm_jpeg_queue_enq(a1, a2);
}

//----- (000017D8) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_deinit(int a1)
{
  return mm_jpeg_queue_deinit(a1);
}

//----- (000017E4) --------------------------------------------------------
int __fastcall j_mm_jpeg_jobmgr_thread_launch(int a1)
{
  return mm_jpeg_jobmgr_thread_launch(a1);
}

//----- (000017F0) --------------------------------------------------------
void *__fastcall j_buffer_allocate(int a1, int a2)
{
  return buffer_allocate(a1, a2);
}

//----- (000017FC) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_jobmgr_thread_release(int a1, int a2, int a3, int a4)
{
  return mm_jpeg_jobmgr_thread_release(a1, a2, a3, a4);
}

//----- (00001814) --------------------------------------------------------
int __fastcall j_buffer_deallocate(int a1, int a2, int a3)
{
  return buffer_deallocate(a1, a2, a3);
}

//----- (0000182C) --------------------------------------------------------
int __fastcall j_mm_jpeg_util_generate_handler(int a1)
{
  return mm_jpeg_util_generate_handler(a1);
}

//----- (00001844) --------------------------------------------------------
int __fastcall j_mm_jpeg_util_get_index_by_handler(int result)
{
  return mm_jpeg_util_get_index_by_handler(result);
}

//----- (00001850) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_create(int a1)
{
  return mm_jpeg_session_create(a1);
}

//----- (0000185C) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_remove_job_by_session_id(int a1, int a2, int a3)
{
  return mm_jpeg_queue_remove_job_by_session_id(a1, a2, a3);
}

//----- (00001868) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_abort(int a1)
{
  return mm_jpeg_session_abort(a1);
}

//----- (00001874) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_destroy(int a1, int a2, int a3, int a4)
{
  return mm_jpeg_session_destroy(a1, a2, a3, a4);
}

//----- (00001880) --------------------------------------------------------
int __fastcall j_mm_jpeg_destroy_session(int a1, int a2)
{
  return mm_jpeg_destroy_session(a1, a2);
}

//----- (0000188C) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_destroy_session_unlocked(int a1, int a2, int a3)
{
  return mm_jpeg_destroy_session_unlocked(a1, a2, a3);
}

//----- (00001898) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_remove_job_by_job_id(int a1, int a2)
{
  return mm_jpeg_queue_remove_job_by_job_id(a1, a2);
}

//----- (000018A4) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_config_main(int a1, int a2, int a3, int a4)
{
  return mm_jpeg_session_config_main(a1, a2, a3, a4);
}

//----- (000018B0) --------------------------------------------------------
int __fastcall j_mm_jpeg_session_config_common(int a1)
{
  return mm_jpeg_session_config_common(a1);
}

//----- (000018BC) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_session_config_main_crop(int a1)
{
  return mm_jpeg_session_config_main_crop(a1);
}

//----- (000018C8) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_session_config_thumbnail(int a1)
{
  return mm_jpeg_session_config_thumbnail(a1);
}

//----- (000018D4) --------------------------------------------------------
int __fastcall j_mm_jpeg_metadata(int a1)
{
  return mm_jpeg_metadata(a1);
}

//----- (000018F8) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_get_size(int a1)
{
  return mm_jpeg_queue_get_size(a1);
}

//----- (00001904) --------------------------------------------------------
int __fastcall j_mm_jpeg_queue_deq(int a1)
{
  return mm_jpeg_queue_deq(a1);
}

//----- (00001910) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_process_encoding_job(int a1, int a2, int a3)
{
  return mm_jpeg_process_encoding_job(a1, a2, a3);
}

//----- (0000191C) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_close(int a1, int a2, int a3)
{
  return mm_jpeg_close(a1, a2, a3);
}

//----- (00001928) --------------------------------------------------------
int __fastcall j_mm_jpeg_deinit(int a1, int a2, int a3, int a4)
{
  return mm_jpeg_deinit(a1, a2, a3, a4);
}

//----- (00001934) --------------------------------------------------------
int __fastcall j_mm_jpeg_destroy_session_by_id(int a1, unsigned __int16 a2, int a3)
{
  return mm_jpeg_destroy_session_by_id(a1, a2, a3);
}

//----- (00001940) --------------------------------------------------------
int __fastcall j_mm_jpeg_create_session(int a1, int a2, int a3, unsigned int *a4)
{
  return mm_jpeg_create_session(a1, a2, a3, a4);
}

//----- (0000194C) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_abort_job(int a1, int a2, int a3)
{
  return mm_jpeg_abort_job(a1, a2, a3);
}

//----- (00001958) --------------------------------------------------------
signed int __fastcall j_mm_jpeg_start_job(int a1, int a2, int *a3)
{
  return mm_jpeg_start_job(a1, a2, a3);
}

//----- (00001964) --------------------------------------------------------
int __fastcall j_mm_jpeg_init(int a1, int a2)
{
  return mm_jpeg_init(a1, a2);
}

//----- (00001970) --------------------------------------------------------
int __fastcall j_mm_jpeg_new_client(char *a1)
{
  return mm_jpeg_new_client(a1);
}

//----- (00001A0C) --------------------------------------------------------
int j___aeabi_ldiv0()
{
  return _aeabi_ldiv0();
}

//----- (00001A24) --------------------------------------------------------
int sub_1A24()
{
  return _cxa_finalize(&off_A000);
}
// 164C: using guessed type int __fastcall _cxa_finalize(_DWORD);
// A000: using guessed type void *off_A000;

//----- (00001A44) --------------------------------------------------------
int (*__fastcall sub_1A44(int (*result)(void)))(void)
{
  if ( result )
    result = (int (*)(void))result();
  return result;
}

//----- (00001B04) --------------------------------------------------------
int __fastcall mm_jpeg_queue_init(int a1)
{
  int v1; // r4@1
  int result; // r0@1

  v1 = a1;
  pthread_mutex_init((pthread_mutex_t *)(a1 + 16), 0);
  result = 0;
  *(_DWORD *)v1 = v1;
  *(_DWORD *)(v1 + 4) = v1;
  *(_DWORD *)(v1 + 12) = 0;
  return result;
}

//----- (00001B1C) --------------------------------------------------------
signed int __fastcall mm_jpeg_queue_enq(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  _DWORD *v4; // r0@1
  _DWORD *v5; // r5@1
  signed int result; // r0@2
  _DWORD *v7; // r3@3

  v2 = a1;
  v3 = a2;
  v4 = malloc(0xCu);
  v5 = v4;
  if ( v4 )
  {
    memset(v4, 0, 0xCu);
    v5[2] = v3;
    pthread_mutex_lock((pthread_mutex_t *)(v2 + 16));
    v7 = *(_DWORD **)(v2 + 4);
    *v5 = v2;
    *(_DWORD *)(v2 + 4) = v5;
    v5[1] = v7;
    *v7 = v5;
    ++*(_DWORD *)(v2 + 12);
    pthread_mutex_unlock((pthread_mutex_t *)(v2 + 16));
    result = 0;
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: No memory for mm_jpeg_q_node_t", "mm_jpeg_queue_enq");
    result = -1;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00001B80) --------------------------------------------------------
int __fastcall mm_jpeg_queue_deq(int a1)
{
  pthread_mutex_t *v1; // r6@1
  int v2; // r5@1
  int v3; // r2@1
  _DWORD *v4; // r3@1
  int v5; // r4@1
  int v6; // r5@7

  v1 = (pthread_mutex_t *)(a1 + 16);
  v2 = a1;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  v5 = *(_DWORD *)v2;
  if ( *(_DWORD *)v2 == v2 )
  {
    v5 = 0;
  }
  else
  {
    v3 = *(_DWORD *)v5;
    v4 = *(_DWORD **)(v5 + 4);
  }
  if ( *(_DWORD *)v2 != v2 )
  {
    *(_DWORD *)(v3 + 4) = v4;
    *v4 = *(_DWORD *)v5;
    *(_DWORD *)v5 = v5;
    *(_DWORD *)(v5 + 4) = v5;
    --*(_DWORD *)(v2 + 12);
  }
  pthread_mutex_unlock(v1);
  if ( v5 )
  {
    v6 = *(_DWORD *)(v5 + 8);
    free((void *)v5);
  }
  else
  {
    v6 = 0;
  }
  return v6;
}

//----- (00001BC8) --------------------------------------------------------
int __fastcall mm_jpeg_queue_get_size(int a1)
{
  pthread_mutex_t *v1; // r4@1
  int v2; // r5@1
  int v3; // r5@1

  v1 = (pthread_mutex_t *)(a1 + 16);
  v2 = a1;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  v3 = *(_DWORD *)(v2 + 12);
  pthread_mutex_unlock(v1);
  return v3;
}

//----- (00001BE2) --------------------------------------------------------
int __fastcall mm_jpeg_queue_flush(int a1)
{
  pthread_mutex_t *v1; // r6@1
  int v2; // r5@1
  int i; // r4@1
  _DWORD *v4; // r3@3
  void *v5; // r0@3

  v1 = (pthread_mutex_t *)(a1 + 16);
  v2 = a1;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  for ( i = *(_DWORD *)v2; i != v2; i = *(_DWORD *)i )
  {
    v4 = *(_DWORD **)(i + 4);
    *(_DWORD *)(*(_DWORD *)i + 4) = v4;
    *v4 = *(_DWORD *)i;
    *(_DWORD *)i = i;
    *(_DWORD *)(i + 4) = i;
    --*(_DWORD *)(v2 + 12);
    v5 = *(void **)(i + 8);
    if ( v5 )
      free(v5);
    free((void *)i);
  }
  *(_DWORD *)(i + 12) = 0;
  pthread_mutex_unlock(v1);
  return 0;
}

//----- (00001C2A) --------------------------------------------------------
int __fastcall mm_jpeg_queue_deinit(int a1)
{
  int v1; // r4@1

  v1 = a1;
  j_mm_jpeg_queue_flush(a1);
  pthread_mutex_destroy((pthread_mutex_t *)(v1 + 16));
  return 0;
}

//----- (00001C3E) --------------------------------------------------------
int __fastcall mm_jpeg_queue_peek(int a1)
{
  pthread_mutex_t *v1; // r6@1
  _DWORD *v2; // r5@1
  _DWORD *v3; // r4@1
  int result; // r0@4

  v1 = (pthread_mutex_t *)(a1 + 16);
  v2 = (_DWORD *)a1;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  v3 = (_DWORD *)*v2;
  if ( (_DWORD *)*v2 == v2 )
    v3 = 0;
  pthread_mutex_unlock(v1);
  if ( v3 )
    result = v3[2];
  else
    result = 0;
  return result;
}

//----- (00001C64) --------------------------------------------------------
int __fastcall addExifEntry(int a1, int a2, int a3, size_t size, int a5)
{
  int v5; // r7@1
  int v6; // r0@1
  signed int v7; // r5@1
  int v8; // t0@1
  size_t v9; // r4@1
  int result; // r0@2
  int v11; // r5@3
  void *v12; // r0@5
  void *v13; // r8@5
  const char *v14; // r1@6
  const char *v15; // r2@6
  const char *v16; // r3@6
  void *v17; // r0@8
  signed int v18; // r12@30
  int v19; // r1@32
  int v20; // r5@32
  size_t v21; // [sp+0h] [bp-20h]@1

  v21 = size;
  v5 = a1;
  v8 = a1;
  v6 = *(_DWORD *)a1;
  v7 = *(_DWORD *)(v8 + 4);
  v9 = size;
  if ( v7 > 49 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: Number of entries exceeded limit", "addExifEntry", size);
    return -1;
  }
  v11 = v6 + 24 * v7;
  *(_DWORD *)(v11 + 20) = a2;
  *(_DWORD *)v11 = a3;
  *(_DWORD *)(v11 + 8) = size;
  *(_BYTE *)(v11 + 4) = 1;
  switch ( a3 )
  {
    case 1:
      if ( size <= 1 )
      {
        *(_BYTE *)(v11 + 12) = *(_BYTE *)a5;
        goto def_1CA6;
      }
      v12 = malloc(size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for byte array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 2:
      v17 = malloc(size + 1);
      v13 = v17;
      if ( !v17 )
      {
        v14 = "mm-jpeg-intf";
        v15 = "%s: No memory for ascii string";
        v16 = "addExifEntry";
        goto LABEL_30;
      }
      memset(v17, 0, v9 + 1);
      v12 = v13;
      goto LABEL_31;
    case 3:
      if ( size <= 1 )
      {
        *(_WORD *)(v11 + 12) = *(_WORD *)a5;
        goto def_1CA6;
      }
      v9 = 2 * size;
      v12 = malloc(2 * size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for short array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 4:
      if ( size <= 1 )
        goto LABEL_26;
      v9 = 4 * size;
      v12 = malloc(4 * size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for long array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 5:
      if ( size <= 1 )
        goto LABEL_32;
      v9 = 8 * size;
      v12 = malloc(8 * size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for rational array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 7:
      v12 = malloc(size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for undefined array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 9:
      if ( size <= 1 )
      {
LABEL_26:
        *(_DWORD *)(v11 + 12) = *(_DWORD *)a5;
        goto def_1CA6;
      }
      v9 = 4 * size;
      v12 = malloc(4 * size);
      v13 = v12;
      if ( v12 )
        goto LABEL_31;
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for signed long array";
      v16 = "addExifEntry";
      goto LABEL_30;
    case 10:
      if ( size <= 1 )
      {
LABEL_32:
        v19 = *(_DWORD *)(a5 + 4);
        v20 = v11 + 12;
        *(_DWORD *)v20 = *(_DWORD *)a5;
        *(_DWORD *)(v20 + 4) = v19;
        goto def_1CA6;
      }
      v9 = 8 * size;
      v12 = malloc(8 * size);
      v13 = v12;
      if ( v12 )
      {
LABEL_31:
        memcpy(v12, (const void *)a5, v9);
        *(_DWORD *)(v11 + 12) = v13;
def_1CA6:
        v18 = 0;
        goto LABEL_34;
      }
      v14 = "mm-jpeg-intf";
      v15 = "%s: No memory for signed rational array";
      v16 = "addExifEntry";
LABEL_30:
      _android_log_print(6, v14, v15, v16, v21);
      v18 = -1;
LABEL_34:
      result = v18;
      ++*(_DWORD *)(v5 + 4);
      return result;
    default:
      goto def_1CA6;
  }
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00001E70) --------------------------------------------------------
int __fastcall releaseExifEntry(int a1)
{
  int v1; // r4@1
  void *v2; // r0@3

  v1 = a1;
  switch ( *(_DWORD *)a1 )
  {
    case 1:
    case 3:
    case 4:
    case 5:
    case 9:
    case 0xA:
      if ( *(_DWORD *)(a1 + 8) > 1u )
        goto LABEL_3;
      break;
    case 2:
    case 7:
LABEL_3:
      v2 = *(void **)(a1 + 12);
      if ( v2 )
      {
        free(v2);
        *(_DWORD *)(v1 + 12) = 0;
      }
      break;
    default:
      return 0;
  }
  return 0;
}

//----- (00001EA0) --------------------------------------------------------
int __fastcall processAAAInfo(int a1, int a2, int a3)
{
  int v3; // r5@1
  signed int v4; // r2@1
  size_t v5; // r7@1
  bool v6; // zf@1
  int v7; // r4@1
  int v8; // r11@1
  void *v9; // r6@5
  void *v10; // r0@16
  const void *v11; // r1@16
  int v12; // r4@19
  int v13; // ST04_4@19
  int v14; // r5@19
  int v15; // r3@19
  int v16; // r0@19
  int v17; // r1@20
  int v18; // r7@21
  signed int v20; // [sp+Ch] [bp-2Ch]@5

  v3 = a3;
  v4 = *(_BYTE *)(a3 + 2412);
  v5 = 2324;
  v6 = v4 == 0;
  v7 = a1;
  v8 = a2;
  if ( !v4 )
  {
    v5 = 2292;
    v4 = 0;
  }
  if ( !v6 )
    v4 = 2292;
  v20 = v4;
  v9 = malloc(v5);
  memset(v9, 164, v5);
  if ( v7 && *(_BYTE *)(v7 + 5972) )
  {
    memcpy(v9, (const void *)(v7 + 5974), 0x554u);
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: ###QExif Add the awb value", "processAAAInfo", 376);
    memcpy(v9, (const void *)v3, 0x554u);
    if ( !v7 )
      goto LABEL_11;
  }
  if ( *(_BYTE *)(v7 + 7338) )
  {
    memcpy((char *)v9 + 1364, (const void *)(v7 + 7340), 0x148u);
    goto LABEL_12;
  }
LABEL_11:
  _android_log_print(6, "mm-jpeg-intf", "%s:%d]: ###QExif Add the af value", "processAAAInfo", 386);
  memcpy((char *)v9 + 1364, (const void *)(v3 + 1364), 0x148u);
  if ( !v7 )
    goto LABEL_14;
LABEL_12:
  if ( !*(_BYTE *)(v7 + 7668) )
  {
LABEL_14:
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: ###QExif Add the alsc value", "processAAAInfo", 396);
    memcpy((char *)v9 + 1692, (const void *)(v3 + 1692), 0xC8u);
    if ( !v7 )
      goto LABEL_17;
    goto LABEL_15;
  }
  memcpy((char *)v9 + 1692, (const void *)(v7 + 7670), 0xC8u);
LABEL_15:
  if ( *(_BYTE *)(v7 + 7870) )
  {
    v10 = (char *)v9 + 1892;
    v11 = (const void *)(v7 + 7872);
    goto LABEL_18;
  }
LABEL_17:
  _android_log_print(6, "mm-jpeg-intf", "%s:%d]: ###QExif Add the aec value", "processAAAInfo", 406);
  v11 = (const void *)(v3 + 1892);
  v10 = (char *)v9 + 1892;
LABEL_18:
  memcpy(v10, v11, 0x190u);
  if ( *(_BYTE *)(v3 + 2412) )
  {
    v12 = v3 + 2340;
    v13 = v3 + 2340;
    v14 = v3 + 2372;
    _android_log_print(3, "mm-jpeg-intf", "%s:%d]: [FW_DBG] EXIF fw cl_number: %s", "processAAAInfo", 413, v13);
    v15 = v12;
    v16 = (int)v9 + v20;
    do
    {
      v17 = *(_DWORD *)(v15 + 4);
      v15 += 8;
      *(_DWORD *)v16 = *(_DWORD *)(v15 - 8);
      *(_DWORD *)(v16 + 4) = v17;
      v16 += 8;
    }
    while ( v15 != v14 );
  }
  v18 = j_addExifEntry(v8, 10719878, 7, v5, (int)v9);
  if ( v18 )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "processAAAInfo", 429);
  free(v9);
  return v18;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000020A4) --------------------------------------------------------
int __fastcall process_meta_data(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r5@1
  int v7; // r1@5
  __int16 v8; // r0@10
  int v13; // r3@17
  int v14; // ST18_4@18
  int v15; // ST20_4@18
  int v16; // r7@26
  __int16 v18; // [sp+2Eh] [bp-32h]@11
  float v19; // [sp+30h] [bp-30h]@21
  int v20; // [sp+34h] [bp-2Ch]@21
  int v21; // [sp+38h] [bp-28h]@26

  v3 = a2;
  v4 = a3;
  v5 = a1;
  if ( a1 && *(_BYTE *)(a1 + 7870) )
    _R4 = a1 + 7872;
  else
    _R4 = a3 + 1892;
  v7 = *(_DWORD *)(a3 + 2336);
  if ( v7 == 2 || v7 == 3 )
  {
    v18 = 1;
  }
  else
  {
    if ( v7 == 1 && a1 && *(_BYTE *)(a1 + 90456) )
      v8 = (unsigned int)(*(_DWORD *)(a1 + 90460) - 2) <= 1;
    else
      v8 = 0;
    v18 = v8;
  }
  if ( j_addExifEntry(v3, 10457609, 3, 1u, (int)&v18) )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 486);
  __asm
  {
    VLDR            S15, [R4,#0x190]
    VLDR            S0, [R4,#0x1AC]
    VLDR            S1, [R4,#0x1B0]
    VCVT.F64.F32    D18, S15
    VCVT.F64.F32    D17, S0
    VCVT.F64.F32    D16, S1
  }
  if ( v5 )
    v13 = *(_DWORD *)(v5 + 90460);
  v14 = *(_WORD *)(_R4 + 440);
  __asm
  {
    VSTR            D18, [SP,#0x60+var_60]
    VSTR            D17, [SP,#0x60+var_58]
    VSTR            D16, [SP,#0x60+var_50]
  }
  v15 = *(_DWORD *)(v4 + 2336);
  _android_log_print(
    6,
    "mm-jpeg-intf",
    "%s: exp_Time:%f, Br value:%f, shutter_speed:%f, iso:%d flash_mode %d %d",
    "process_meta_data");
  v18 = *(_WORD *)(_R4 + 440);
  if ( j_addExifEntry(v3, 9472039, 3, 1u, (int)&v18) )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 503);
  __asm
  {
    VLDR            S2, [R4,#0x1AC]
    VCMP.F32        S2, #0.0
    VMRS            APSR_nzcv, FPSCR
  }
  if ( !_ZF )
  {
    __asm { VLDR            S14, =100.0 }
    v20 = 100;
    __asm
    {
      VMUL.F32        S3, S2, S14
      VCVTR.S32.F32   S4, S3
      VSTR            S4, [SP,#0x60+var_30]
    }
    if ( j_addExifEntry(v3, 10064387, 10, 1u, (int)&v19) )
      _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 513);
  }
  __asm
  {
    VLDR            S5, [R4,#0x1B0]
    VCMP.F32        S5, #0.0
    VMRS            APSR_nzcv, FPSCR
  }
  if ( !_ZF )
  {
    __asm
    {
      VLDR            S6, =100.0
      VMUL.F32        S7, S5, S6
    }
    v20 = 100;
    __asm
    {
      VCVTR.S32.F32   S8, S7
      VSTR            S8, [SP,#0x60+var_30]
    }
    if ( j_addExifEntry(v3, 9933313, 10, 1u, (int)&v19) )
      _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 524);
  }
  __asm
  {
    VLDR            S9, [R4,#0x190]
    VCVTR.U32.F32   S10, S9
  }
  v21 = 1;
  __asm { VSTR            S10, [SP,#0x60+var_24] }
  v16 = j_addExifEntry(v3, 9208474, 5, 1u, (int)&v21);
  if ( v16 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 535);
    _android_log_print(6, "mm-jpeg-intf", "%s:%d]: Error adding Exif Entry", "process_meta_data", 546);
  }
  return v16;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002304) --------------------------------------------------------
int __fastcall mm_jpeg_session_free_buffers(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r8@1
  int v6; // r5@1
  unsigned int i; // r4@1
  int v8; // t1@3
  int v9; // r0@3
  int v10; // r4@4
  const char *v11; // r1@4
  const char *v12; // r2@4
  const char *v13; // r3@4
  int v14; // r8@6
  unsigned int j; // r7@6
  int v16; // t1@9
  int v17; // r0@9
  int v18; // r6@12
  unsigned int k; // r7@12
  int v20; // t1@14
  signed int v22; // [sp+0h] [bp-28h]@4
  int v23; // [sp+4h] [bp-24h]@1
  int v24; // [sp+4h] [bp-24h]@4
  int v25; // [sp+8h] [bp-20h]@1

  v23 = a2;
  v25 = a3;
  v3 = a1 + 105472;
  v4 = a1 + 105476;
  v5 = a1 + 104960;
  v6 = a1;
  for ( i = 0; i < *(_DWORD *)(v6 + 12); ++i )
  {
    v8 = *(_DWORD *)(v4 + 4);
    v4 += 4;
    v9 = (*(int (__cdecl **)(_DWORD, _DWORD, int))(*(_DWORD *)(v5 + 504) + 60))(*(_DWORD *)(v5 + 504), 0, v8);
    if ( v9 )
    {
      v10 = v9;
      v22 = 336;
      v24 = v9;
      v11 = "mm-jpeg-intf";
      v12 = "%s:%d] Error %d";
      v13 = "mm_jpeg_session_free_buffers";
LABEL_11:
      _android_log_print(6, v11, v12, v13, v22, v24, v25);
      return v10;
    }
  }
  v14 = v3 + 100;
  for ( j = 0; j < *(_DWORD *)(v6 + 16); ++j )
  {
    v16 = *(_DWORD *)(v14 + 4);
    v14 += 4;
    v17 = (*(int (__cdecl **)(_DWORD, signed int, int))(*(_DWORD *)(v6 + 105464) + 60))(
            *(_DWORD *)(v6 + 105464),
            2,
            v16);
    if ( v17 )
    {
      v10 = v17;
      v22 = 345;
      v24 = v17;
      v11 = "mm-jpeg-intf";
      v12 = "%s:%d] Error %d";
      v13 = "mm_jpeg_session_free_buffers";
      goto LABEL_11;
    }
  }
  v18 = v3 + 196;
  for ( k = 0; k < *(_DWORD *)(v6 + 20); ++k )
  {
    v20 = *(_DWORD *)(v18 + 4);
    v18 += 4;
    v10 = (*(int (__cdecl **)(_DWORD, signed int, int))(*(_DWORD *)(v6 + 105464) + 60))(
            *(_DWORD *)(v6 + 105464),
            1,
            v20);
    if ( v10 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_free_buffers", 354, v23, v25);
      return v10;
    }
  }
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000023FC) --------------------------------------------------------
int __fastcall mm_jpeg_ebd(int a1, int a2)
{
  pthread_mutex_t *v2; // r5@1
  int v3; // r4@1

  v2 = (pthread_mutex_t *)(a2 + 106056);
  v3 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a2 + 106056));
  ++*(_DWORD *)(v3 + 107404);
  pthread_mutex_unlock(v2);
  return 0;
}

//----- (00002424) --------------------------------------------------------
int __fastcall sub_2424(int a1)
{
  pthread_mutex_t *v1; // r5@1
  int v2; // r4@1

  v1 = (pthread_mutex_t *)(a1 + 4);
  v2 = a1;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  ++*(_DWORD *)v2;
  pthread_cond_signal((pthread_cond_t *)(v2 + 8));
  return j_j_pthread_mutex_unlock(v1);
}

//----- (00002448) --------------------------------------------------------
int __fastcall mm_jpeg_session_send_buffers(int a1)
{
  int v1; // r8@1
  int v2; // r10@1
  int v3; // r11@1
  int v4; // r5@1
  int v5; // r7@1
  unsigned int v6; // r6@1
  int v7; // r0@3
  int v8; // ST00_4@3
  int v9; // r1@3
  int v10; // r2@3
  int v11; // r0@3
  int v12; // r4@4
  const char *v13; // r1@4
  const char *v14; // r2@4
  const char *v15; // r3@4
  int v16; // r10@6
  int v17; // r6@6
  unsigned int i; // r7@6
  int v19; // r1@9
  int v20; // r1@9
  int v21; // r2@9
  int v22; // r0@9
  int v23; // r8@12
  int *v24; // r6@12
  unsigned int j; // r7@12
  int v26; // r1@14
  int v27; // ST00_4@14
  int v28; // r4@14
  signed int v30; // [sp+0h] [bp-38h]@4
  int v31; // [sp+4h] [bp-34h]@4
  int v32; // [sp+4h] [bp-34h]@14
  int v33; // [sp+8h] [bp-30h]@1
  int v34; // [sp+Ch] [bp-2Ch]@1

  v1 = a1 + 105472;
  v2 = a1 + 105480;
  v3 = a1 + 104960;
  v4 = a1;
  v5 = a1;
  v6 = 0;
  v33 = 0;
  v34 = 0;
  while ( v6 < *(_DWORD *)(v4 + 12) )
  {
    v7 = *(_DWORD *)(v3 + 504);
    v8 = *(_DWORD *)(v5 + 40);
    v9 = v2;
    v10 = *(_DWORD *)(v5 + 32);
    v2 += 4;
    v33 = *(_DWORD *)(v5 + 36);
    v5 += 288;
    v11 = (*(int (__cdecl **)(int, int, _DWORD, int *))(v7 + 52))(v7, v9, 0, &v33);
    if ( v11 )
    {
      v12 = v11;
      v30 = 280;
      v31 = v11;
      v13 = "mm-jpeg-intf";
      v14 = "%s:%d] Error %d";
      v15 = "mm_jpeg_session_send_buffers";
LABEL_11:
      _android_log_print(6, v13, v14, v15, v30, v31, v33, v34);
      return v12;
    }
    ++v6;
  }
  v16 = v1 + 104;
  v17 = v4 + 6948;
  for ( i = 0; i < *(_DWORD *)(v4 + 16); ++i )
  {
    v19 = *(_DWORD *)(v17 + 4);
    v33 = *(_DWORD *)v17;
    v20 = v16;
    v21 = *(_DWORD *)(v17 - 4);
    v16 += 4;
    v17 += 288;
    v22 = (*(int (__cdecl **)(_DWORD, int, signed int, int *))(*(_DWORD *)(v4 + 105464) + 52))(
            *(_DWORD *)(v4 + 105464),
            v20,
            2,
            &v33);
    if ( v22 )
    {
      v12 = v22;
      v30 = 293;
      v31 = v22;
      v13 = "mm-jpeg-intf";
      v14 = "%s:%d] Error %d";
      v15 = "mm_jpeg_session_send_buffers";
      goto LABEL_11;
    }
  }
  v23 = v1 + 200;
  v24 = (int *)(v4 + 13864);
  for ( j = 0; j < *(_DWORD *)(v4 + 20); ++j )
  {
    v26 = v23;
    v23 += 4;
    v27 = *v24;
    v28 = *(v24 - 2);
    v24 += 72;
    v32 = v28;
    v12 = (*(int (__cdecl **)(_DWORD, int, signed int, _DWORD))(*(_DWORD *)(v4 + 105464) + 52))(
            *(_DWORD *)(v4 + 105464),
            v26,
            1,
            0);
    if ( v12 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_send_buffers", 304, v32, v33, v34);
      return v12;
    }
  }
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002598) --------------------------------------------------------
int __fastcall mm_jpeg_session_change_state(int a1, int a2, int (__fastcall *a3)(_DWORD), int a4)
{
  int v4; // r8@1
  pthread_mutex_t *v5; // r5@1
  int v6; // r7@1
  int v7; // r6@1
  int v8; // r10@1
  int (__fastcall *v9)(int); // r9@1
  int v10; // r2@1
  int v11; // r4@1
  int v12; // r4@3
  int v13; // ST04_4@4
  int v14; // r0@8
  int (__fastcall *v16)(_DWORD); // [sp+8h] [bp-28h]@1
  int v17; // [sp+Ch] [bp-24h]@1

  v16 = a3;
  v17 = a4;
  v4 = a1 + 105984;
  v5 = (pthread_mutex_t *)(a1 + 106056);
  v6 = a1;
  v7 = a1 + 104960;
  v8 = a2;
  v9 = a3;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 106056));
  v11 = (*(int (__cdecl **)(_DWORD, int *, int))(*(_DWORD *)(v7 + 504) + 44))(*(_DWORD *)(v7 + 504), &v17, v10);
  if ( v11 || v17 == v8 )
    goto LABEL_12;
  *(_DWORD *)(v7 + 492) = 1;
  pthread_mutex_unlock(v5);
  v12 = (*(int (__cdecl **)(_DWORD, _DWORD, int))(*(_DWORD *)(v7 + 504) + 20))(*(_DWORD *)(v7 + 504), 0, v8);
  pthread_mutex_lock(v5);
  if ( !v12 )
  {
    v11 = *(_DWORD *)(v7 + 496);
    if ( v11 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error %d", "mm_jpeg_session_change_state", 412, v11, v16);
      pthread_mutex_unlock(v5);
      return *(_DWORD *)(v7 + 496);
    }
    if ( v9 )
    {
      v14 = v9(v6);
      if ( v14 )
      {
        v11 = v14;
        _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error %d", "mm_jpeg_session_change_state", 419, v14, v16);
        pthread_mutex_unlock(v5);
        return v11;
      }
    }
    if ( *(_DWORD *)(v7 + 492) )
      pthread_cond_wait((pthread_cond_t *)(v4 + 76), v5);
LABEL_12:
    pthread_mutex_unlock(v5);
    return v11;
  }
  v13 = v12;
  v11 = -2147479529;
  _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error %d", "mm_jpeg_session_change_state", 406, v13, v16);
  pthread_mutex_unlock(v5);
  return v11;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000026B8) --------------------------------------------------------
int __fastcall mm_jpeg_session_create(int a1)
{
  int v1; // r4@1
  int v2; // r5@1
  int v3; // r6@1
  int v4; // r3@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r4@1

  v1 = a1 + 105984;
  v2 = a1;
  v3 = a1 + 107008;
  pthread_mutex_init((pthread_mutex_t *)(a1 + 106056), 0);
  pthread_cond_init((pthread_cond_t *)(v1 + 76), 0);
  *(_DWORD *)(v3 + 380) = 0;
  *(_DWORD *)(v3 + 384) = 0;
  *(_DWORD *)(v3 + 388) = 0;
  pthread_mutex_init((pthread_mutex_t *)(v3 + 392), 0);
  v4 = v2 + 104960;
  v5 = v2 + 105472;
  *(_DWORD *)(v4 + 492) = 0;
  *(_DWORD *)(v4 + 500) = 0;
  *(_DWORD *)(v4 + 496) = 0;
  *(_DWORD *)(v3 + 396) = 0;
  *(_DWORD *)(v3 + 400) = 0;
  *(_DWORD *)(v4 + 480) = -1;
  *(_DWORD *)(v3 + 408) = 0;
  *(_DWORD *)v5 = mm_jpeg_ebd;
  *(_DWORD *)(v5 + 4) = mm_jpeg_fbd;
  *(_DWORD *)(v2 + 105468) = mm_jpeg_event_handler;
  v6 = OMX_GetHandle(v2 + 105464, "OMX.qcom.image.jpeg.encoder", v2);
  v7 = v6;
  if ( v6 )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] OMX_GetHandle failed (%d)", "mm_jpeg_session_create", 472, v6);
  return v7;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 1718: using guessed type int __fastcall OMX_GetHandle(_DWORD, _DWORD, _DWORD);

//----- (00002784) --------------------------------------------------------
int __fastcall mm_jpeg_release_exif(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r6@1
  int result; // r0@1
  int v6; // r4@1
  int v7; // [sp+8h] [bp-20h]@1

  v7 = a3;
  v3 = *(_DWORD *)(a1 + 20780);
  v4 = a1;
  result = a1 + 24 * v3;
  v6 = result + 106064;
  while ( v3 < *(_DWORD *)(v4 + 107264) )
  {
    result = j_releaseExifEntry(v6);
    if ( result )
      result = _android_log_print(
                 6,
                 "mm-jpeg-intf",
                 "%s:%d] Exif release failed (%d)",
                 "mm_jpeg_release_exif",
                 498,
                 result,
                 v7);
    ++v3;
    v6 += 24;
  }
  *(_DWORD *)(v4 + 107264) = 0;
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000027F4) --------------------------------------------------------
int __fastcall mm_jpeg_session_destroy(int a1, int a2, int a3, int a4)
{
  int v4; // r5@1
  int v5; // r6@1
  int result; // r0@2
  int v7; // r7@3
  pthread_mutex_t *v8; // r4@3
  int v9; // r2@8
  int v10; // r2@10
  int v11; // r3@10
  int v12; // r1@10
  int v13; // r0@13
  int v14; // [sp+4h] [bp-24h]@1
  int v15; // [sp+8h] [bp-20h]@1
  int v16; // [sp+Ch] [bp-1Ch]@1

  v14 = a2;
  v15 = a3;
  v16 = a4;
  v4 = a1 + 104960;
  v5 = a1;
  if ( *(_DWORD *)(a1 + 105464) )
  {
    v7 = a1 + 105984;
    v8 = (pthread_mutex_t *)(a1 + 106056);
    pthread_mutex_lock((pthread_mutex_t *)(a1 + 106056));
    if ( (*(int (__cdecl **)(_DWORD, int *, _DWORD))(*(_DWORD *)(v4 + 504) + 44))(
           *(_DWORD *)(v4 + 504),
           &v16,
           *(_DWORD *)(*(_DWORD *)(v4 + 504) + 44)) )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_destroy", 530, v14, v15);
    }
    pthread_mutex_unlock(v8);
    if ( (unsigned int)(v16 - 3) <= 1 && j_mm_jpeg_session_change_state(v5, 2, 0, v16 - 3) )
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_destroy", 538, v14, v15);
    pthread_mutex_lock(v8);
    if ( (*(int (__cdecl **)(_DWORD, int *, int))(*(_DWORD *)(v4 + 504) + 44))(*(_DWORD *)(v4 + 504), &v16, v9) )
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_destroy", 545, v14, v15);
    pthread_mutex_unlock(v8);
    v12 = v16;
    if ( v16 == 2
      && j_mm_jpeg_session_change_state(v5, 1, (int (__fastcall *)(_DWORD))mm_jpeg_session_free_buffers, v11) )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_destroy", 554, v14, v15);
    }
    j_mm_jpeg_release_exif(v5, v12, v10);
    v13 = OMX_FreeHandle(*(_DWORD *)(v4 + 504));
    if ( v13 )
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] OMX_FreeHandle failed (%d)",
        "mm_jpeg_session_destroy",
        561,
        v13,
        v15);
    *(_DWORD *)(v4 + 504) = 0;
    pthread_mutex_destroy(v8);
    result = pthread_cond_destroy((pthread_cond_t *)(v7 + 76));
  }
  else
  {
    result = _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid handle", "mm_jpeg_session_destroy", 523, a2, a3);
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 1748: using guessed type int __fastcall OMX_FreeHandle(_DWORD);

//----- (00002974) --------------------------------------------------------
int __fastcall mm_jpeg_session_config_main_buffer_offset(int a1)
{
  int v1; // r4@1
  int v2; // r5@1
  int v3; // r6@1
  int v4; // r5@1
  int v5; // r0@1
  int v6; // r2@1
  int v7; // r4@1
  int v8; // r7@1
  int v9; // r3@1
  int v10; // r9@1
  int v11; // r4@1
  const char *v12; // r1@2
  const char *v13; // r2@2
  const char *v14; // r3@2
  signed int v16; // [sp+0h] [bp-58h]@2
  int s; // [sp+24h] [bp-34h]@1
  int v18; // [sp+28h] [bp-30h]@1
  int v19; // [sp+2Ch] [bp-2Ch]@1
  int v20; // [sp+30h] [bp-28h]@1
  int v21; // [sp+34h] [bp-24h]@1

  v1 = *(_DWORD *)(a1 + 20824);
  v2 = a1;
  memset(&s, 0, 0x14u);
  v3 = v2 + 288 * v1;
  v4 = v2 + 104960;
  v5 = *(_DWORD *)(v4 + 504);
  v6 = *(_DWORD *)(v3 + 52);
  v7 = *(_DWORD *)(v3 + 120);
  v8 = *(_DWORD *)(v3 + 56);
  v9 = *(_DWORD *)(v3 + 88);
  v21 = *(_DWORD *)(v3 + 84);
  v20 = v6;
  v19 = v7;
  v10 = *(_DWORD *)(v3 + 40);
  s = v8;
  v18 = v9;
  v11 = (*(int (**)(void))(v5 + 40))();
  if ( v11 )
  {
    v12 = "mm-jpeg-intf";
    v16 = 608;
    v13 = "%s:%d] Failed";
    v14 = "mm_jpeg_session_config_main_buffer_offset";
LABEL_5:
    _android_log_print(6, v12, v13, v14, v16);
    return v11;
  }
  _android_log_print(
    6,
    "mm-jpeg-intf",
    "%s:%d] yOffset = %d, cbcrOffset = (%d %d), totalSize = %d,cbcrStartOffset = (%d %d)",
    "mm_jpeg_session_config_main_buffer_offset",
    619,
    s,
    v18,
    v19,
    v10,
    v20,
    v21);
  v11 = (*(int (**)(void))(*(_DWORD *)(v4 + 504) + 28))();
  if ( v11 )
  {
    v16 = 623;
    v12 = "mm-jpeg-intf";
    v14 = "mm_jpeg_session_config_main_buffer_offset";
    v13 = "%s:%d] Failed";
    goto LABEL_5;
  }
  return v11;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002A5C) --------------------------------------------------------
int __fastcall mm_jpeg_encoding_mode(int a1)
{
  int v1; // r7@1
  int v2; // r4@1
  const char *v3; // r2@2
  const char *v4; // r1@2
  const char *v5; // r3@2
  signed int v7; // [sp+0h] [bp-28h]@2
  signed int v8; // [sp+Ch] [bp-1Ch]@3

  v1 = a1 + 104960;
  v2 = (*(int (**)(void))(*(_DWORD *)(a1 + 105464) + 40))();
  if ( v2 )
  {
    v7 = 656;
    v3 = "%s:%d] Failed";
    v4 = "mm-jpeg-intf";
    v5 = "mm_jpeg_encoding_mode";
LABEL_5:
    _android_log_print(6, v4, v3, v5, v7);
    return v2;
  }
  v8 = 1;
  _android_log_print(6, "mm-jpeg-intf", "%s:%d] encoding mode = %d ", "mm_jpeg_encoding_mode", 666, 1);
  v2 = (*(int (**)(void))(*(_DWORD *)(v1 + 504) + 28))();
  if ( v2 )
  {
    v4 = "mm-jpeg-intf";
    v7 = 669;
    v3 = "%s:%d] Failed";
    v5 = "mm_jpeg_encoding_mode";
    goto LABEL_5;
  }
  return v2;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002AFC) --------------------------------------------------------
signed int __fastcall map_jpeg_format(int a1, int a2, int a3)
{
  signed int result; // r0@2

  switch ( a1 )
  {
    case 1:
      result = 21;
      break;
    case 2:
      result = 2130707201;
      break;
    case 3:
      result = 24;
      break;
    case 4:
      result = 2130707202;
      break;
    case 5:
      result = 2130707203;
      break;
    case 6:
      result = 2130707204;
      break;
    case 7:
      result = 2130707205;
      break;
    case 0:
      goto LABEL_10;
    default:
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid format %d", "map_jpeg_format", 707, a1, a3);
LABEL_10:
      result = 2130707200;
      break;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002B70) --------------------------------------------------------
int __fastcall mm_jpeg_session_config_ports(int a1)
{
  int v1; // r5@1
  int v2; // r7@1
  int v3; // r0@1
  int v4; // r6@1
  int v5; // r7@1
  int v6; // r9@1
  const char *v7; // r1@2
  const char *v8; // r2@2
  const char *v9; // r3@2
  int v11; // r1@8
  int v12; // r4@8
  const char *v13; // r1@9
  const char *v14; // r2@9
  const char *v15; // r3@9
  int v16; // r4@11
  int v17; // lr@11
  int v18; // r2@11
  int v19; // r1@11
  int v20; // r2@13
  int v21; // r2@15
  signed int v22; // [sp+0h] [bp-38h]@2
  signed int v23; // [sp+0h] [bp-38h]@9
  int v24; // [sp+Ch] [bp-2Ch]@1

  v1 = a1;
  v2 = a1 + 20736;
  v3 = *(_DWORD *)(a1 + 20824);
  v4 = v1 + 105472;
  *(_DWORD *)(v4 + 304) = 0;
  *(_DWORD *)(v4 + 400) = 1;
  v5 = v2 + 88;
  *(_DWORD *)(v4 + 496) = 2;
  v24 = v3;
  v6 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 24))();
  if ( v6 )
  {
    v7 = "mm-jpeg-intf";
    v22 = 740;
    v8 = "%s:%d] failed";
    v9 = "mm_jpeg_session_config_ports";
LABEL_5:
    _android_log_print(6, v7, v8, v9, v22);
    return v6;
  }
  v6 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 24))();
  if ( v6 )
  {
    v7 = "mm-jpeg-intf";
    v8 = "%s:%d] failed";
    v22 = 747;
    v9 = "mm_jpeg_session_config_ports";
    goto LABEL_5;
  }
  v6 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 24))();
  if ( v6 )
  {
    v22 = 754;
    v7 = "mm-jpeg-intf";
    v8 = "%s:%d] failed";
    v9 = "mm_jpeg_session_config_ports";
    goto LABEL_5;
  }
  *(_DWORD *)(v1 + 105816) = *(_DWORD *)(v5 + 48);
  *(_DWORD *)(v1 + 105820) = *(_DWORD *)(v5 + 52);
  *(_DWORD *)(v1 + 105824) = *(_DWORD *)(v1 + 288 * v24 + 68);
  v11 = *(_DWORD *)(v1 + 288 * v24 + 72);
  *(_DWORD *)(v1 + 105828) = v11;
  *(_DWORD *)(v1 + 105840) = j_map_jpeg_format(*(_DWORD *)(v1 + 20764), v11, v24);
  *(_DWORD *)(v1 + 105792) = *(_DWORD *)(v1 + 288 * *(_DWORD *)(v1 + 20824) + 40);
  *(_DWORD *)(v1 + 105784) = *(_DWORD *)(v1 + 12);
  v12 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 28))();
  if ( v12 )
  {
    v23 = 774;
    v13 = "mm-jpeg-intf";
    v14 = "%s:%d] failed";
    v15 = "mm_jpeg_session_config_ports";
LABEL_19:
    _android_log_print(6, v13, v14, v15, v23);
    return v12;
  }
  if ( *(_BYTE *)(v1 + 24) )
  {
    v16 = v1 + 105984;
    v17 = v1 + 288 * *(_DWORD *)(v5 + 8);
    *(_DWORD *)(v16 + 24) = *(_DWORD *)(v5 + 12);
    v18 = *(_DWORD *)(v5 + 16);
    *(_DWORD *)(v16 + 28) = v18;
    *(_DWORD *)(v16 + 32) = *(_DWORD *)(v17 + 6980);
    v19 = *(_DWORD *)(v17 + 6984);
    *(_DWORD *)(v16 + 36) = v19;
    *(_DWORD *)(v1 + 106032) = j_map_jpeg_format(*(_DWORD *)(v1 + 20764), v19, v18);
    *(_DWORD *)v16 = *(_DWORD *)(v1 + 288 * *(_DWORD *)(v5 + 8) + 6952);
    *(_DWORD *)(v1 + 105976) = *(_DWORD *)(v1 + 16);
    v6 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 28))();
    if ( v6 )
    {
      v22 = 798;
      v8 = "%s:%d] failed";
      v7 = "mm-jpeg-intf";
      v9 = "mm_jpeg_session_config_ports";
      goto LABEL_5;
    }
    v20 = *(_DWORD *)(v1 + 105968);
    v12 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 20))();
    if ( v12 )
    {
      v13 = "mm-jpeg-intf";
      v23 = 807;
      v14 = "%s:%d] failed";
      v15 = "mm_jpeg_session_config_ports";
      goto LABEL_19;
    }
  }
  else
  {
    v21 = *(_DWORD *)(v1 + 105968);
    v12 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 20))();
    if ( v12 )
    {
      v13 = "mm-jpeg-intf";
      v23 = 816;
      v14 = "%s:%d] failed";
      v15 = "mm_jpeg_session_config_ports";
      goto LABEL_19;
    }
  }
  *(_DWORD *)(v1 + 105888) = *(_DWORD *)(v1 + 288 * *(_DWORD *)(v5 + 4) + 13864);
  *(_DWORD *)(v1 + 105880) = *(_DWORD *)(v1 + 20);
  v12 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 28))();
  if ( v12 )
  {
    v13 = "mm-jpeg-intf";
    v14 = "%s:%d] failed";
    v23 = 827;
    v15 = "mm_jpeg_session_config_ports";
    goto LABEL_19;
  }
  return v12;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00002E10) --------------------------------------------------------
signed int __fastcall mm_jpeg_session_config_thumbnail(int a1)
{
  int v1; // r6@1
  int v2; // r10@1
  const char *v3; // r1@4
  const char *v4; // r2@4
  const char *v5; // r3@4
  int v6; // r2@5
  int v7; // r3@6
  signed int result; // r0@9
  int v9; // r5@13
  int v10; // r0@13
  int v11; // r9@16
  int v12; // r0@16
  int v13; // r5@16
  int v14; // r1@18
  int v15; // r3@18
  int v16; // r7@18
  int v17; // r3@18
  int v18; // r0@18
  int v19; // r5@18
  int v20; // r2@18
  int v21; // r0@19
  int v22; // r4@20
  int v23; // r6@22
  int v24; // r3@22
  int v25; // r2@22
  int v26; // r4@22
  int v27; // r7@22
  int v28; // r0@22
  int v29; // r5@22
  signed int v30; // [sp+0h] [bp-90h]@4
  int s; // [sp+24h] [bp-6Ch]@16
  int v32; // [sp+28h] [bp-68h]@18
  char v33; // [sp+2Ch] [bp-64h]@18
  int v34; // [sp+3Ch] [bp-54h]@18
  int v35; // [sp+40h] [bp-50h]@18
  int v36; // [sp+44h] [bp-4Ch]@18
  int v37; // [sp+48h] [bp-48h]@18
  int v38; // [sp+4Ch] [bp-44h]@20
  int v39; // [sp+50h] [bp-40h]@20
  int v40; // [sp+54h] [bp-3Ch]@22
  int v41; // [sp+58h] [bp-38h]@22
  int v42; // [sp+5Ch] [bp-34h]@22
  int v43; // [sp+60h] [bp-30h]@22
  int v44; // [sp+64h] [bp-2Ch]@22
  int v45; // [sp+6Ch] [bp-24h]@18

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 20832);
  _android_log_print(
    6,
    "mm-jpeg-intf",
    "%s:%d] encode_thumbnail %d",
    "mm_jpeg_session_config_thumbnail",
    860,
    *(_BYTE *)(a1 + 24));
  if ( *(_BYTE *)(v1 + 24) )
  {
    if ( !*(_DWORD *)(v1 + 20844) || !*(_DWORD *)(v1 + 20848) )
    {
      v3 = "mm-jpeg-intf";
      v30 = 867;
      v4 = "%s:%d] Error invalid output dim for thumbnail";
      v5 = "mm_jpeg_session_config_thumbnail";
LABEL_8:
      _android_log_print(6, v3, v4, v5, v30);
      return -2147479547;
    }
    v6 = *(_DWORD *)(v1 + 20836);
    if ( !v6 || (v7 = *(_DWORD *)(v1 + 20840)) == 0 )
    {
      v30 = 873;
      v3 = "mm-jpeg-intf";
      v4 = "%s:%d] Error invalid input dim for thumbnail";
      v5 = "mm_jpeg_session_config_thumbnail";
      goto LABEL_8;
    }
    if ( !*(_DWORD *)(v1 + 20860) || !*(_DWORD *)(v1 + 20864) )
    {
      *(_DWORD *)(v1 + 20860) = v6;
      *(_DWORD *)(v1 + 20864) = v7;
    }
    v9 = *(_DWORD *)(v1 + 20860);
    v10 = *(_DWORD *)(v1 + 20852);
    if ( v9 + v10 > v6 || *(_DWORD *)(v1 + 20856) + *(_DWORD *)(v1 + 20864) > v7 )
    {
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] invalid crop boundary (%d, %d) offset (%d, %d) out of (%d, %d)",
        "mm_jpeg_session_config_thumbnail",
        892,
        v9,
        *(_DWORD *)(v1 + 20864),
        v10,
        *(_DWORD *)(v1 + 20856),
        v6,
        v7);
      return -2147479547;
    }
    v11 = v1 + 104960;
    memset(&s, 0, 0x4Cu);
    v12 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 40))();
    v13 = v12;
    if ( v12 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error %d", "mm_jpeg_session_config_thumbnail", 901, v12);
      result = v13;
    }
    else
    {
      v14 = *(_DWORD *)(v1 + 20836);
      v36 = *(_DWORD *)(v1 + 20860);
      v15 = *(_DWORD *)(v1 + 20772);
      v33 = 1;
      v16 = *(_DWORD *)(v1 + 20840);
      v45 = v15;
      v17 = *(_DWORD *)(v1 + 20844);
      v18 = *(_DWORD *)(v1 + 20864);
      v19 = *(_DWORD *)(v1 + 20852);
      v20 = *(_DWORD *)(v1 + 20856);
      s = v14;
      v32 = v16;
      v37 = v18;
      v34 = v19;
      v35 = v20;
      if ( v17 <= v14 && (v21 = *(_DWORD *)(v1 + 20848), v21 <= v16) )
      {
        v38 = v17;
        v39 = v21;
      }
      else
      {
        _android_log_print(
          6,
          "mm-jpeg-intf",
          "%s:%d] Incorrect thumbnail dim %dx%d resetting to %dx%d",
          "mm_jpeg_session_config_thumbnail",
          945,
          v17,
          *(_DWORD *)(v1 + 20848),
          v14,
          v16);
        v22 = *(_DWORD *)(v1 + 20840);
        v38 = *(_DWORD *)(v1 + 20836);
        v39 = v22;
      }
      memset(&v40, 0, 0x14u);
      v23 = v1 + 288 * v2;
      v24 = *(_DWORD *)(v23 + 6964);
      v25 = *(_DWORD *)(v23 + 7032);
      v26 = *(_DWORD *)(v23 + 7000);
      v27 = *(_DWORD *)(v23 + 6968);
      v28 = *(_DWORD *)(v11 + 504);
      v44 = *(_DWORD *)(v23 + 6996);
      v42 = v25;
      v43 = v24;
      v40 = v27;
      v41 = v26;
      v29 = (*(int (**)(void))(v28 + 36))();
      if ( v29 )
        _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_session_config_thumbnail", 964);
      result = v29;
    }
  }
  else
  {
    result = *(_BYTE *)(v1 + 24);
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (0000305C) --------------------------------------------------------
signed int __fastcall mm_jpeg_session_config_main_crop(int a1)
{
  int v1; // r4@1
  int v2; // r5@1
  int v3; // r2@3
  int v4; // r7@4
  int v5; // r11@4
  int v6; // r3@4
  int v7; // r6@5
  int v8; // r10@5
  int v10; // ST18_4@7
  int v11; // r0@11
  int v12; // r7@11
  int v13; // r6@11
  int v14; // r4@12
  int v15; // r5@14
  int v16; // r6@14
  const char *v17; // r1@15
  const char *v18; // r2@15
  const char *v19; // r3@15
  signed int v20; // [sp+0h] [bp-80h]@15
  int v21; // [sp+1Ch] [bp-64h]@7
  char s; // [sp+20h] [bp-60h]@7
  int v23; // [sp+2Ch] [bp-54h]@11
  int v24; // [sp+30h] [bp-50h]@11
  int v25; // [sp+34h] [bp-4Ch]@11
  int v26; // [sp+38h] [bp-48h]@11
  char v27; // [sp+3Ch] [bp-44h]@7
  int v28; // [sp+50h] [bp-30h]@13
  int v29; // [sp+54h] [bp-2Ch]@13

  v1 = a1 + 20872;
  v2 = a1;
  if ( !*(_DWORD *)(a1 + 20896) || !*(_DWORD *)(a1 + 20900) )
  {
    v3 = *(_DWORD *)(a1 + 20872);
    *(_DWORD *)(a1 + 20900) = *(_DWORD *)(a1 + 20876);
    *(_DWORD *)(a1 + 20896) = v3;
  }
  v4 = *(_DWORD *)(a1 + 20896);
  v5 = *(_DWORD *)(a1 + 20888);
  v6 = *(_DWORD *)(a1 + 20872);
  if ( v4 + v5 > v6 || (v7 = *(_DWORD *)(a1 + 20900), v8 = *(_DWORD *)(a1 + 20892), v7 + v8 > *(_DWORD *)(a1 + 20876)) )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] invalid crop boundary (%d, %d) out of (%d, %d)",
      "mm_jpeg_session_config_main_crop",
      1003,
      v4 + v5,
      *(_DWORD *)(a1 + 20892) + *(_DWORD *)(a1 + 20900),
      v6,
      *(_DWORD *)(a1 + 20876));
    return -2147479547;
  }
  v21 = *(_DWORD *)(a1 + 20876);
  v10 = *(_DWORD *)(a1 + 20872);
  memset(&s, 0, 0x1Cu);
  memset(&v27, 0, 0x1Cu);
  if ( v10 != v4 || v21 != v7 || v4 != *(_DWORD *)(v1 + 8) || v7 != *(_DWORD *)(v1 + 12) )
  {
    v11 = (v4 + 1) & 0xFFFE;
    v12 = (v7 + 1) & 0xFFFE;
    v13 = *(_DWORD *)(v1 + 8);
    v25 = v11;
    v26 = v12;
    v23 = v5;
    v24 = v8;
    if ( v13 )
    {
      v14 = *(_DWORD *)(v1 + 12);
      if ( v14 )
      {
        v28 = v13;
        v29 = v14;
      }
    }
  }
  v15 = v2 + 104960;
  v16 = (*(int (**)(void))(*(_DWORD *)(v15 + 504) + 36))();
  if ( v16 )
  {
    v20 = 1031;
    v17 = "mm-jpeg-intf";
    v18 = "%s:%d] Error";
    v19 = "mm_jpeg_session_config_main_crop";
LABEL_18:
    _android_log_print(6, v17, v18, v19, v20);
    return v16;
  }
  v16 = (*(int (**)(void))(*(_DWORD *)(v15 + 504) + 36))();
  if ( v16 )
  {
    v20 = 1044;
    v18 = "%s:%d] Error";
    v17 = "mm-jpeg-intf";
    v19 = "mm_jpeg_session_config_main_crop";
    goto LABEL_18;
  }
  return v16;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000031C0) --------------------------------------------------------
int __fastcall mm_jpeg_session_config_main(int a1, int a2, int a3, int a4)
{
  int v4; // r5@1
  int v5; // r4@1
  const char *v6; // r1@2
  const char *v7; // r2@2
  const char *v8; // r3@2
  int v10; // [sp+0h] [bp-10h]@1

  v10 = a4;
  v4 = a1;
  v5 = j_mm_jpeg_session_config_ports(a1);
  if ( v5 )
  {
    v6 = "mm-jpeg-intf";
    v7 = "%s: config port failed";
    v8 = "mm_jpeg_session_config_main";
  }
  else
  {
    v5 = j_mm_jpeg_session_config_main_buffer_offset(v4);
    if ( !v5 )
    {
      j_mm_jpeg_encoding_mode(v4);
      return v5;
    }
    v6 = "mm-jpeg-intf";
    v7 = "%s: config buffer offset failed";
    v8 = "mm_jpeg_session_config_main";
  }
  _android_log_print(6, v6, v7, v8, v10);
  return v5;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (0000321C) --------------------------------------------------------
int __fastcall mm_jpeg_session_config_common(int a1)
{
  int v1; // r5@1
  int v2; // r6@1
  int v3; // r8@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r4@1
  const char *v7; // r1@2
  const char *v8; // r2@2
  const char *v9; // r3@2
  int v10; // r2@3
  int v11; // r1@3
  int v12; // r4@3
  int v13; // r6@7
  int v14; // r0@8
  int v15; // r0@10
  signed int v17; // [sp+0h] [bp-40h]@2
  int v18; // [sp+4h] [bp-3Ch]@2
  int v19; // [sp+10h] [bp-30h]@3
  int v20; // [sp+14h] [bp-2Ch]@3
  char s; // [sp+18h] [bp-28h]@1
  int v22; // [sp+20h] [bp-20h]@1
  int v23; // [sp+24h] [bp-1Ch]@1

  v1 = a1;
  v2 = a1 + 20824;
  v3 = a1 + 104960;
  memset(&s, 0, 0x10u);
  v4 = *(_DWORD *)(v2 + 44);
  v22 = 1;
  v23 = v4;
  v5 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 36))();
  v6 = v5;
  if ( v5 )
  {
    v17 = 1123;
    v18 = v5;
    v7 = "mm-jpeg-intf";
    v8 = "%s:%d] Error %d";
    v9 = "mm_jpeg_session_config_common";
LABEL_12:
    _android_log_print(6, v7, v8, v9, v17, v18);
    return v6;
  }
  memset((void *)(v1 + 106064), 0, 0x4B0u);
  v11 = 20780;
  v12 = *(_DWORD *)(v1 + 20780);
  v19 = v1 + 106064;
  v20 = v12;
  if ( v12 )
    memcpy((void *)(v1 + 106064), *(const void **)(v1 + 20776), 24 * v12);
  j_mm_jpeg_release_exif(v1, v11, v10);
  if ( *(_BYTE *)(v2 + 2502) )
    j_processAAAInfo(*(_DWORD *)(v2 + 84), (int)&v19, v2 + 88);
  j_process_meta_data(*(_DWORD *)(v2 + 84), (int)&v19, v2 + 88);
  v13 = v20;
  *(_DWORD *)(v1 + 107264) = v20;
  if ( !v13 )
    return 0;
  v14 = (*(int (**)(void))(*(_DWORD *)(v1 + 105464) + 40))();
  v6 = v14;
  if ( v14 )
  {
    v17 = 1168;
    v18 = v14;
    v7 = "mm-jpeg-intf";
    v8 = "%s:%d] Error %d";
    v9 = "mm_jpeg_session_config_common";
    goto LABEL_12;
  }
  v15 = (*(int (**)(void))(*(_DWORD *)(v3 + 504) + 36))();
  v6 = v15;
  if ( v15 )
  {
    v17 = 1175;
    v18 = v15;
    v7 = "mm-jpeg-intf";
    v8 = "%s:%d] Error %d";
    v9 = "mm_jpeg_session_config_common";
    goto LABEL_12;
  }
  return v6;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003358) --------------------------------------------------------
int __fastcall mm_jpeg_session_abort(int a1)
{
  int v1; // r7@1
  pthread_mutex_t *v2; // r4@1
  int v3; // r6@1
  int v4; // r5@1
  int v5; // r6@2

  v1 = a1 + 105984;
  v2 = (pthread_mutex_t *)(a1 + 106056);
  v3 = a1;
  v4 = a1 + 104960;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 106056));
  if ( *(_DWORD *)(v4 + 500) )
    goto LABEL_7;
  *(_DWORD *)(v4 + 500) = 1;
  v5 = *(_DWORD *)(v3 + 107424);
  if ( v5 != 1 )
  {
LABEL_6:
    *(_DWORD *)(v4 + 500) = 2;
LABEL_7:
    v5 = 0;
    pthread_mutex_unlock(v2);
    return v5;
  }
  *(_DWORD *)(v4 + 492) = 1;
  pthread_mutex_unlock(v2);
  if ( !(*(int (**)(void))(*(_DWORD *)(v4 + 504) + 20))() )
  {
    pthread_mutex_lock(v2);
    if ( *(_DWORD *)(v4 + 500) == 1 )
      pthread_cond_wait((pthread_cond_t *)(v1 + 76), v2);
    goto LABEL_6;
  }
  return v5;
}

//----- (000033D4) --------------------------------------------------------
signed int __fastcall mm_jpeg_get_new_session_idx(int a1, int a2, _DWORD *a3)
{
  int v3; // r9@1
  _DWORD *v4; // r8@1
  int v5; // r5@1
  int v6; // r7@1
  pthread_mutex_t *v7; // r6@1
  int v8; // r10@1
  int v9; // r4@2

  v3 = a1;
  v4 = a3;
  v5 = 0;
  v6 = 1074732 * a2;
  v7 = (pthread_mutex_t *)(a1 + 1074732 * a2 + 1074732);
  v8 = 1074732 * a2;
  do
  {
    v9 = 107472 * v5;
    pthread_mutex_lock(v7);
    if ( !*(_DWORD *)(v3 + 107472 * v5 + v6 + 107424) )
    {
      *v4 = v3 + v9 + v8 + 12;
      *(_DWORD *)(v9 + v8 + v3 + 107424) = 1;
      pthread_mutex_unlock(v7);
      return v5;
    }
    ++v5;
    pthread_mutex_unlock(v7);
  }
  while ( v5 != 10 );
  return -1;
}

//----- (0000344C) --------------------------------------------------------
int __fastcall mm_jpeg_remove_session_idx(int a1, unsigned __int16 a2)
{
  int v2; // r7@1
  unsigned __int16 v3; // r4@1
  int v4; // r6@1
  pthread_mutex_t *v5; // r5@1

  v2 = a1;
  v3 = a2;
  v4 = 1074732 * (unsigned __int8)a2;
  v5 = (pthread_mutex_t *)(a1 + v4 + 1074732);
  pthread_mutex_lock(v5);
  *(_DWORD *)(v2 + v4 + 107472 * (v3 >> 8) + 107424) = 0;
  return j_j_pthread_mutex_unlock(v5);
}

//----- (00003490) --------------------------------------------------------
int __fastcall mm_jpeg_get_session(int a1, unsigned __int16 a2, int a3)
{
  signed int v3; // r4@1
  int v4; // r7@1
  int result; // r0@3
  int v6; // r6@4
  pthread_mutex_t *v7; // r5@4

  v3 = a2 >> 8;
  v4 = a1;
  if ( v3 <= 9 && (signed int)(unsigned __int8)a2 <= 7 )
  {
    v6 = 1074732 * (unsigned __int8)a2;
    v7 = (pthread_mutex_t *)(a1 + v6 + 1074732);
    pthread_mutex_lock(v7);
    pthread_mutex_unlock(v7);
    result = v6 + 107472 * v3 + v4 + 12;
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid job id %x", "mm_jpeg_get_session", 1314, a2, a3);
    result = 0;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003500) --------------------------------------------------------
int __fastcall mm_jpeg_metadata(int a1)
{
  int v1; // r6@1
  int v2; // r5@1
  int v3; // r4@1
  const char *v4; // r1@2
  const char *v5; // r2@2
  const char *v6; // r3@2
  int v7; // r1@3
  int v8; // r0@3
  signed int v10; // [sp+0h] [bp-28h]@2
  int v11; // [sp+10h] [bp-18h]@3
  int v12; // [sp+14h] [bp-14h]@3

  v1 = a1 + 104960;
  v2 = a1;
  v3 = (*(int (**)(void))(*(_DWORD *)(a1 + 105464) + 40))();
  if ( v3 )
  {
    v4 = "mm-jpeg-intf";
    v10 = 1347;
    v5 = "%s: %d Failed";
    v6 = "mm_jpeg_metadata";
LABEL_5:
    _android_log_print(6, v4, v5, v6, v10);
    return v3;
  }
  v7 = *(_DWORD *)(v2 + 20908);
  v8 = *(_DWORD *)(v1 + 504);
  v12 = 449796;
  v11 = v7;
  v3 = (*(int (**)(void))(v8 + 36))();
  if ( v3 )
  {
    v4 = "mm-jpeg-intf";
    v5 = "%s %d failed";
    v10 = 1357;
    v6 = "mm_jpeg_metadata";
    goto LABEL_5;
  }
  return v3;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003590) --------------------------------------------------------
int __fastcall mm_jpeg_jobmgr_thread_launch(int a1)
{
  int v1; // r4@1
  int v2; // r6@1

  v1 = a1;
  v2 = a1 + 8597868;
  pthread_mutex_init((pthread_mutex_t *)(a1 + 8597872), 0);
  pthread_cond_init((pthread_cond_t *)(v2 + 8), 0);
  *(_DWORD *)(v1 + 8597868) = 0;
  j_mm_jpeg_queue_init(v1 + 8597880);
  pthread_create((pthread_t *)(v1 + 8597864), 0, (void *(*)(void *))sub_4478, (void *)v1);
  return 0;
}

//----- (000035D4) --------------------------------------------------------
signed int __fastcall mm_jpeg_jobmgr_thread_release(int a1, int a2, int a3, int a4)
{
  int v4; // r6@1
  void *v5; // r4@1
  _DWORD *v6; // r0@1
  _DWORD *v7; // r7@1
  signed int result; // r0@2
  int v9; // [sp+0h] [bp-18h]@1

  v9 = a4;
  v4 = a1;
  v5 = (void *)(a1 + 8597864);
  v6 = malloc(0x14A94u);
  v7 = v6;
  if ( v6 )
  {
    memset(v6, 0, 0x14A94u);
    *v7 = 1;
    j_mm_jpeg_queue_enq((int)v5 + 16, (int)v7);
    sub_2424((int)v5 + 4);
    pthread_join(*(_DWORD *)(v4 + 8597864), 0);
    j_mm_jpeg_queue_deinit((int)v5 + 16);
    pthread_mutex_destroy((pthread_mutex_t *)(v4 + 8597872));
    pthread_cond_destroy((pthread_cond_t *)(v4 + 8597876));
    memset(v5, 0, 0x24u);
    result = 0;
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: No memory for mm_jpeg_job_q_node_t", "mm_jpeg_jobmgr_thread_release", v9);
    result = -1;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003664) --------------------------------------------------------
int __fastcall mm_jpeg_init(int a1, int a2)
{
  int v2; // r4@1
  pthread_mutex_t *v3; // r5@1
  int v4; // r6@1
  const char *v5; // r1@2
  const char *v6; // r2@2
  const char *v7; // r3@2
  void *v8; // r0@5
  int v9; // r2@5
  int v10; // r3@5
  int result; // r0@7
  int v12; // r1@9
  int v13; // r2@9
  int v14; // r1@9
  int v15; // r2@9
  int v16; // r3@9
  signed int v17; // [sp+0h] [bp-20h]@2
  int v18; // [sp+4h] [bp-1Ch]@1

  v18 = a2;
  v2 = a1;
  v3 = (pthread_mutex_t *)(a1 + 8597860);
  v4 = a1 + 8597900;
  pthread_mutex_init((pthread_mutex_t *)(a1 + 8597860), 0);
  if ( j_mm_jpeg_queue_init(v4) )
  {
    v5 = "mm-jpeg-intf";
    v17 = 1834;
    v6 = "%s:%d] Error";
    v7 = "mm_jpeg_init";
LABEL_7:
    _android_log_print(6, v5, v6, v7, v17, v18);
    return -1;
  }
  if ( j_mm_jpeg_jobmgr_thread_launch(v2) )
  {
    v5 = "mm-jpeg-intf";
    v17 = 1842;
    v6 = "%s:%d] Error";
    v7 = "mm_jpeg_init";
    goto LABEL_7;
  }
  *(_DWORD *)(v2 + 8597952) = 20000768;
  v8 = j_buffer_allocate(v2 + 8597920, 0);
  *(_DWORD *)(v2 + 8597960) = v8;
  if ( !v8 )
  {
    j_mm_jpeg_jobmgr_thread_release(v2, 8597960, v9, v10);
    j_mm_jpeg_queue_deinit(v4);
    pthread_mutex_destroy(v3);
    v5 = "mm-jpeg-intf";
    v6 = "%s:%d] Ion allocation failed";
    v17 = 1854;
    v7 = "mm_jpeg_init";
    goto LABEL_7;
  }
  result = OMX_Init(v8, 8597960);
  if ( result )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] OMX_Init failed (%d)", "mm_jpeg_init", 1862, 0);
    j_buffer_deallocate(v2 + 8597920, v12, v13);
    j_mm_jpeg_jobmgr_thread_release(v2, v14, v15, v16);
    j_mm_jpeg_queue_deinit(v4);
    pthread_mutex_destroy(v3);
    result = 0;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 1808: using guessed type int __cdecl OMX_Init(_DWORD, _DWORD);

//----- (0000378C) --------------------------------------------------------
int __fastcall mm_jpeg_deinit(int a1, int a2, int a3, int a4)
{
  int v4; // r4@1
  signed int v5; // r0@1
  int v6; // r1@3
  int v7; // r2@3
  int v8; // r5@5
  int v10; // [sp+4h] [bp-14h]@1
  int v11; // [sp+8h] [bp-10h]@1

  v10 = a2;
  v11 = a3;
  v4 = a1;
  v5 = j_mm_jpeg_jobmgr_thread_release(a1, a2, a3, a4);
  if ( v5 )
    v5 = _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_deinit", 1891, v10, v11);
  OMX_Deinit(v5);
  if ( j_mm_jpeg_queue_deinit(v4 + 8597900) )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error", "mm_jpeg_deinit", 1900, v10, v11);
  v8 = j_buffer_deallocate(v4 + 8597920, v6, v7);
  if ( v8 )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] Error releasing ION buffer", "mm_jpeg_deinit", 1907, v10, v11);
  pthread_mutex_destroy((pthread_mutex_t *)(v4 + 8597860));
  return v8;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 1820: using guessed type int __fastcall OMX_Deinit(_DWORD);

//----- (00003838) --------------------------------------------------------
int __fastcall mm_jpeg_new_client(char *a1)
{
  char *v1; // r5@1
  int v2; // r1@3
  int v3; // r6@4
  int v4; // r8@4
  const pthread_mutexattr_t *v5; // r4@4
  int v6; // r7@6
  int v7; // r0@7
  int v8; // r12@7
  int v9; // r6@7

  v1 = a1;
  if ( *(_DWORD *)a1 <= 7 )
  {
    v2 = 0;
    while ( 1 )
    {
      v3 = 1074732 * v2;
      v4 = (int)&a1[1074732 * v2];
      v5 = (const pthread_mutexattr_t *)*(_BYTE *)(v4 + 4);
      if ( !*(_BYTE *)(v4 + 4) )
        break;
      if ( ++v2 == 8 )
        goto LABEL_6;
    }
    v7 = j_mm_jpeg_util_generate_handler((unsigned __int8)v2);
    v8 = (int)&v1[v3 + 1073152];
    v9 = v3 + 12;
    v6 = v7;
    *(_DWORD *)(v4 + 8) = v7;
    *(_BYTE *)(v4 + 4) = 1;
    pthread_mutex_init((pthread_mutex_t *)(v8 + 1580), v5);
    do
    {
      memset(&v1[(_DWORD)v5 + v9], 0, 0x1A3D0u);
      v5 += 26868;
    }
    while ( v5 != (const pthread_mutexattr_t *)1074720 );
    ++*(_DWORD *)v1;
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: num of clients reached limit", "mm_jpeg_new_client");
LABEL_6:
    v6 = 0;
  }
  return v6;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000038D8) --------------------------------------------------------
signed int __fastcall mm_jpeg_start_job(int a1, int a2, int *a3)
{
  int v3; // r5@1
  int v4; // r7@1
  int v5; // r6@1
  unsigned int v6; // r4@1
  unsigned int v7; // r5@1
  const char *v8; // r1@3
  const char *v9; // r2@3
  const char *v10; // r3@3
  int v11; // r4@4
  void *v12; // r9@10
  signed int v14; // r0@13
  int v15; // r11@13
  int v16; // r5@13
  int v17; // r6@13
  int v18; // r12@13
  signed int v19; // r4@13
  signed int v20; // [sp+0h] [bp-40h]@3
  int v21; // [sp+4h] [bp-3Ch]@3
  int *v22; // [sp+14h] [bp-2Ch]@1

  *a3 = 0;
  v3 = *(_DWORD *)(a2 + 84);
  v22 = a3;
  v4 = a1;
  v5 = a2;
  v6 = (unsigned __int8)v3;
  v7 = (unsigned __int16)v3 >> 8;
  _android_log_print(6, "mm-jpeg-intf", "%s:%d] session_idx %d client idx %d", "mm_jpeg_start_job", 1999, v7, v6);
  if ( v7 > 9 || v6 > 7 )
  {
    v20 = 2004;
    v8 = "mm-jpeg-intf";
    v21 = *(_DWORD *)(v5 + 84);
    v9 = "%s:%d] invalid session id %x";
    v10 = "mm_jpeg_start_job";
LABEL_6:
    _android_log_print(6, v8, v9, v10, v20, v21);
    return -1;
  }
  v11 = 1074732 * v6 + 107472 * v7 + v4;
  if ( !*(_DWORD *)(v11 + 107424) )
  {
    v20 = 2011;
    v8 = "mm-jpeg-intf";
    v10 = "mm_jpeg_start_job";
    v21 = *(_DWORD *)(v5 + 84);
    v9 = "%s:%d] session not active %x";
    goto LABEL_6;
  }
  if ( *(_DWORD *)(v5 + 4) >= *(_DWORD *)(v11 + 24) || *(_DWORD *)(v5 + 8) >= *(_DWORD *)(v11 + 32) )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid buffer indices", "mm_jpeg_start_job", 2017);
    return -1;
  }
  v12 = malloc(0x14A94u);
  if ( !v12 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: No memory for mm_jpeg_job_q_node_t", "mm_jpeg_start_job");
    return -1;
  }
  v14 = *(_DWORD *)(v11 + 107432);
  v15 = *(_DWORD *)(v5 + 84);
  *(_DWORD *)(v11 + 107432) = v14 + 1;
  v16 = v15 | (v14 % 10000 << 16);
  *v22 = v16;
  memset(v12, 0, 0x14A94u);
  memcpy((char *)v12 + 4, (const void *)(v5 + 4), 0x14A88u);
  v17 = *(_DWORD *)(v11 + 12);
  v18 = (int)v12 + 84480;
  *(_DWORD *)(v18 + 140) = v16;
  *(_DWORD *)(v18 + 144) = v17;
  *(_DWORD *)v12 = 0;
  v19 = j_mm_jpeg_queue_enq(v4 + 8597880, (int)v12);
  if ( !v19 )
    sub_2424(v4 + 8597868);
  return v19;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003A5C) --------------------------------------------------------
int __fastcall mm_jpeg_create_session(int a1, int a2, int a3, unsigned int *a4)
{
  unsigned int *v4; // r8@1
  int v5; // r7@1
  int v6; // r9@1
  bool v7; // cf@1
  bool v8; // zf@1
  const void *v9; // r10@1
  const char *v10; // r1@3
  const char *v11; // r2@3
  const char *v12; // r3@3
  unsigned int v13; // r6@4
  signed int v14; // r0@7
  int v15; // lr@9
  int v16; // r1@9
  int v17; // r2@9
  int v18; // r3@9
  int v19; // r12@9
  int v20; // r1@9
  int v21; // r2@9
  int v22; // r3@9
  int v23; // r1@9
  int v24; // r2@9
  int v25; // r0@9
  int *v26; // r4@9
  void *v27; // r0@11
  int v28; // r9@11
  signed int v30; // [sp+0h] [bp-40h]@3
  signed int v31; // [sp+Ch] [bp-34h]@9
  int v32; // [sp+14h] [bp-2Ch]@1

  v4 = a4;
  *a4 = 0;
  v5 = a1;
  v6 = a2;
  v7 = *(_DWORD *)a3 >= 0x18u;
  v8 = *(_DWORD *)a3 == 24;
  v9 = (const void *)a3;
  v32 = 0;
  if ( !v8 && v7 || *(_DWORD *)(a3 + 8) > 0x18u )
  {
    v10 = "mm-jpeg-intf";
    v30 = 2129;
    v11 = "%s:%d] invalid num buffers";
    v12 = "mm_jpeg_create_session";
  }
  else
  {
    v13 = j_mm_jpeg_util_get_index_by_handler(a2);
    if ( v13 <= 7 )
    {
      v14 = mm_jpeg_get_new_session_idx(v5, v13, &v32);
      if ( v14 < 0 )
      {
        _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid session id (%d)", "mm_jpeg_create_session", 2142, v14);
        return 0;
      }
      v15 = v32;
      v31 = v14;
      v16 = *(_DWORD *)(v5 + 8597924);
      v17 = *(_DWORD *)(v5 + 8597928);
      v18 = *(_DWORD *)(v5 + 8597932);
      v19 = v32 + 107428;
      *(_DWORD *)v19 = *(_DWORD *)(v5 + 8597920);
      *(_DWORD *)(v19 + 4) = v16;
      *(_DWORD *)(v19 + 8) = v17;
      *(_DWORD *)(v19 + 12) = v18;
      v19 += 16;
      v20 = *(_DWORD *)(v5 + 8597940);
      v21 = *(_DWORD *)(v5 + 8597944);
      v22 = *(_DWORD *)(v5 + 8597948);
      *(_DWORD *)v19 = *(_DWORD *)(v5 + 8597936);
      *(_DWORD *)(v19 + 4) = v20;
      *(_DWORD *)(v19 + 8) = v21;
      *(_DWORD *)(v19 + 12) = v22;
      v19 += 16;
      v23 = *(_DWORD *)(v5 + 8597956);
      v24 = *(_DWORD *)(v5 + 8597960);
      *(_DWORD *)v19 = *(_DWORD *)(v5 + 8597952);
      *(_DWORD *)(v19 + 4) = v23;
      *(_DWORD *)(v19 + 8) = v24;
      v25 = j_mm_jpeg_session_create(v15);
      v26 = (int *)v32;
      if ( !v25 )
      {
        v27 = (void *)(v32 + 12);
        *v4 = v13 | 0x1000000 | (v31 << 8);
        memcpy(v27, v9, 0x514Cu);
        *v26 = v6;
        v28 = v32 + 104960;
        *(_DWORD *)(v32 + 8) = *v4;
        *(_DWORD *)(v28 + 484) = v5;
        return 0;
      }
      *(_DWORD *)(v32 + 107412) = 0;
      v10 = "mm-jpeg-intf";
      v30 = 2151;
      v11 = "%s:%d] jpeg session create failed";
      v12 = "mm_jpeg_create_session";
    }
    else
    {
      v10 = "mm-jpeg-intf";
      v11 = "%s: invalid client with handler (%d)";
      v30 = v6;
      v12 = "mm_jpeg_create_session";
    }
  }
  _android_log_print(6, v10, v11, v12, v30);
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003BA8) --------------------------------------------------------
int __fastcall mm_jpeg_queue_remove_job_by_client_id(int a1, int a2, int a3)
{
  pthread_mutex_t *v3; // r9@1
  int v4; // r5@1
  int v5; // r7@1
  _DWORD *i; // r4@1
  int v7; // r6@3
  _DWORD *v8; // r3@5
  int v10; // [sp+4h] [bp-24h]@1
  int v11; // [sp+8h] [bp-20h]@1

  v10 = a2;
  v11 = a3;
  v3 = (pthread_mutex_t *)(a1 + 16);
  v4 = a1;
  v5 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  for ( i = *(_DWORD **)v4; i != (_DWORD *)v4; i = (_DWORD *)*i )
  {
    v7 = i[2];
    if ( v7 && *(_DWORD *)(v7 + 84624) == v5 )
    {
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] found matching client handle",
        "mm_jpeg_queue_remove_job_by_client_id",
        2482,
        v10,
        v11);
      v8 = (_DWORD *)i[1];
      *(_DWORD *)(*i + 4) = v8;
      *v8 = *i;
      *i = i;
      i[1] = i;
      --*(_DWORD *)(v4 + 12);
      free(i);
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s: queue size = %d",
        "mm_jpeg_queue_remove_job_by_client_id",
        *(_DWORD *)(v4 + 12));
      goto LABEL_8;
    }
  }
  v7 = 0;
LABEL_8:
  pthread_mutex_unlock(v3);
  return v7;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003C40) --------------------------------------------------------
int __fastcall mm_jpeg_queue_remove_job_by_session_id(int a1, int a2, int a3)
{
  pthread_mutex_t *v3; // r9@1
  int v4; // r5@1
  int v5; // r7@1
  _DWORD *i; // r4@1
  int v7; // r6@3
  _DWORD *v8; // r3@5
  int v10; // [sp+4h] [bp-24h]@1
  int v11; // [sp+8h] [bp-20h]@1

  v10 = a2;
  v11 = a3;
  v3 = (pthread_mutex_t *)(a1 + 16);
  v4 = a1;
  v5 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  for ( i = *(_DWORD **)v4; i != (_DWORD *)v4; i = (_DWORD *)*i )
  {
    v7 = i[2];
    if ( v7 && *(_DWORD *)(v7 + 84) == v5 )
    {
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] found matching session id",
        "mm_jpeg_queue_remove_job_by_session_id",
        2516,
        v10,
        v11);
      v8 = (_DWORD *)i[1];
      *(_DWORD *)(*i + 4) = v8;
      *v8 = *i;
      *i = i;
      i[1] = i;
      --*(_DWORD *)(v4 + 12);
      free(i);
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s: queue size = %d",
        "mm_jpeg_queue_remove_job_by_session_id",
        *(_DWORD *)(v4 + 12));
      goto LABEL_8;
    }
  }
  v7 = 0;
LABEL_8:
  pthread_mutex_unlock(v3);
  return v7;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003CD4) --------------------------------------------------------
int __fastcall mm_jpeg_destroy_session(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r7@1
  int v4; // r5@3
  pthread_mutex_t *v5; // r6@3
  int v6; // r2@3
  void *v7; // r0@4
  int v8; // r2@4
  void *v9; // r0@6
  int v10; // r1@8
  int v11; // r2@8
  int v12; // r3@8

  v2 = a1;
  v3 = a2;
  if ( a2 )
  {
    v4 = *(_DWORD *)(a2 + 8);
    v5 = (pthread_mutex_t *)(a1 + 8597860);
    pthread_mutex_lock((pthread_mutex_t *)(a1 + 8597860));
    while ( 1 )
    {
      v7 = (void *)j_mm_jpeg_queue_remove_job_by_session_id(v2 + 8597880, v4, v6);
      if ( !v7 )
        break;
      free(v7);
    }
    while ( 1 )
    {
      v9 = (void *)j_mm_jpeg_queue_remove_job_by_session_id(v2 + 8597900, v4, v8);
      if ( !v9 )
        break;
      free(v9);
    }
    j_mm_jpeg_session_abort(v3);
    j_mm_jpeg_session_destroy(v3, v10, v11, v12);
    mm_jpeg_remove_session_idx(v2, v4);
    pthread_mutex_unlock(v5);
    sub_2424(v2 + 8597868);
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid session", "mm_jpeg_destroy_session", 2190, 0);
  }
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003D78) --------------------------------------------------------
int __fastcall mm_jpeg_destroy_session_by_id(int a1, unsigned __int16 a2, int a3)
{
  int v3; // r4@1
  int v4; // r1@1

  v3 = a1;
  v4 = mm_jpeg_get_session(a1, a2, a3);
  return j_j_j_mm_jpeg_destroy_session(v3, v4);
}

//----- (00003D8C) --------------------------------------------------------
signed int __fastcall mm_jpeg_destroy_session_unlocked(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r4@3
  int v6; // r5@3
  void *v7; // r0@4
  int v8; // r2@4
  void *v9; // r0@6

  v3 = a1;
  v4 = a2;
  if ( a2 )
  {
    v5 = *(_DWORD *)(a2 + 8);
    v6 = a1 + 8597880;
    while ( 1 )
    {
      v7 = (void *)j_mm_jpeg_queue_remove_job_by_session_id(v6, v5, a3);
      if ( !v7 )
        break;
      free(v7);
    }
    while ( 1 )
    {
      v9 = (void *)j_mm_jpeg_queue_remove_job_by_session_id(v3 + 8597900, v5, v8);
      if ( !v9 )
        break;
      free(v9);
    }
    j_mm_jpeg_session_abort(v4);
    mm_jpeg_remove_session_idx(v3, v5);
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid session", "mm_jpeg_destroy_session_unlocked", 2249, 0, a3);
  }
  return -1;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003E04) --------------------------------------------------------
signed int __fastcall mm_jpeg_close(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r4@1
  unsigned int v5; // r8@1
  signed int result; // r0@2
  int v7; // r4@3
  int v8; // [sp+4h] [bp-2Ch]@1
  int v9; // [sp+8h] [bp-28h]@1

  v8 = a2;
  v9 = a3;
  v3 = a1;
  v4 = a2;
  v5 = j_mm_jpeg_util_get_index_by_handler(a2);
  if ( v5 <= 7 )
  {
    v7 = 0;
    pthread_mutex_lock((pthread_mutex_t *)(v3 + 8597860));
    do
    {
      if ( *(_DWORD *)(v3 + v7 + 1074732 * v5 + 107424) == 1 )
        j_mm_jpeg_destroy_session_unlocked(v3, 1074732 * v5 + 12 + v7 + v3, 1);
      v7 += 107472;
    }
    while ( v7 != 1074720 );
    pthread_mutex_unlock((pthread_mutex_t *)(v3 + 8597860));
    pthread_mutex_destroy((pthread_mutex_t *)(v3 + 1074732 * v5 + 1074732));
    memset((void *)(v3 + 1074732 * v5 + 4), 0, 0x10662Cu);
    result = 0;
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s: invalid client with handler (%d)", "mm_jpeg_close", v4, v8, v9);
    result = -1;
  }
  return result;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003EBC) --------------------------------------------------------
int __fastcall mm_jpeg_queue_remove_job_by_job_id(int a1, int a2)
{
  pthread_mutex_t *v2; // r7@1
  int v3; // r5@1
  int v4; // r8@1
  _DWORD *i; // r4@1
  int v6; // r6@3
  _DWORD *v7; // r3@5
  int v9; // [sp+4h] [bp-1Ch]@1

  v9 = a2;
  v2 = (pthread_mutex_t *)(a1 + 16);
  v3 = a1;
  v4 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 16));
  for ( i = *(_DWORD **)v3; i != (_DWORD *)v3; i = (_DWORD *)*i )
  {
    v6 = i[2];
    if ( v6 && *(_DWORD *)(v6 + 84620) == v4 )
    {
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] found matching job id",
        "mm_jpeg_queue_remove_job_by_job_id",
        2550,
        v9);
      v7 = (_DWORD *)i[1];
      *(_DWORD *)(*i + 4) = v7;
      *v7 = *i;
      *i = i;
      i[1] = i;
      --*(_DWORD *)(v3 + 12);
      free(i);
      goto LABEL_8;
    }
  }
  v6 = 0;
LABEL_8:
  pthread_mutex_unlock(v2);
  return v6;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00003F38) --------------------------------------------------------
int __fastcall sub_3F38(int a1)
{
  int v1; // r4@1
  int v2; // r5@1
  void *v3; // r0@1
  int v4; // r1@1

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 105444);
  v3 = (void *)j_mm_jpeg_queue_remove_job_by_job_id(v2 + 8597900, *(_DWORD *)(a1 + 4));
  if ( v3 )
    free(v3);
  *(_DWORD *)(v1 + 107424) = 0;
  j_mm_jpeg_release_exif(v1, v4, 0);
  return sub_2424(v2 + 8597868);
}

//----- (00003F78) --------------------------------------------------------
signed int __fastcall mm_jpeg_process_encoding_job(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r6@1
  int v5; // r7@1
  int v6; // r5@1
  signed int v8; // r7@3
  int v9; // r2@5
  int v10; // r3@5
  int v11; // r1@6
  int v12; // r3@8
  int v13; // r0@10
  int v14; // r3@10
  const char *v15; // r1@11
  const char *v16; // r2@11
  const char *v17; // r3@11
  int v18; // r0@12
  signed int v19; // r4@18
  const char *v20; // r1@19
  const char *v21; // r2@19
  const char *v22; // r3@19
  int v23; // r0@20
  int v24; // r0@20
  const char *v25; // r1@21
  const char *v26; // r2@21
  const char *v27; // r3@21
  const char *v28; // r1@23
  const char *v29; // r2@23
  const char *v30; // r3@23
  int v31; // r0@24
  int v32; // ST04_4@27
  int v33; // ST0C_4@27
  const char *v34; // r2@34
  const char *v35; // r1@34
  const char *v36; // r3@34
  const char *v37; // r1@36
  const char *v38; // r2@36
  const char *v39; // r3@36
  int v40; // r1@37
  int v41; // r1@40
  int v42; // r1@42
  void (__cdecl *v43)(signed int); // r4@44
  int v44; // ST00_4@45
  int v45; // r1@45
  signed int v46; // [sp+0h] [bp-60h]@11
  signed int v47; // [sp+0h] [bp-60h]@21
  signed int v48; // [sp+0h] [bp-60h]@23
  signed int v49; // [sp+0h] [bp-60h]@34
  signed int v50; // [sp+0h] [bp-60h]@36
  int v51; // [sp+4h] [bp-5Ch]@11
  int v52; // [sp+4h] [bp-5Ch]@21
  int v53; // [sp+1Ch] [bp-44h]@24
  int v54; // [sp+20h] [bp-40h]@27
  int v55; // [sp+24h] [bp-3Ch]@27
  char s; // [sp+28h] [bp-38h]@20
  int v57; // [sp+34h] [bp-2Ch]@20

  v3 = a2 + 84480;
  v4 = a2;
  v5 = a1;
  v6 = mm_jpeg_get_session(a1, *(_DWORD *)(a2 + 84620), a3);
  if ( !v6 )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] invalid job id %x",
      "mm_jpeg_process_encoding_job",
      1638,
      *(_DWORD *)(v3 + 140));
    return -1;
  }
  v8 = j_mm_jpeg_queue_enq(v5 + 8597900, v4);
  if ( v8 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] jpeg enqueue failed %d", "mm_jpeg_process_encoding_job", 1646, 0);
LABEL_49:
    sub_3F38(v6);
    return v8;
  }
  memcpy((void *)(v6 + 20824), (const void *)(v4 + 4), 0x14A88u);
  *(_DWORD *)(v6 + 4) = *(_DWORD *)(v3 + 140);
  pthread_mutex_lock((pthread_mutex_t *)(v6 + 106056));
  *(_DWORD *)(v6 + 105460) = 0;
  *(_DWORD *)(v6 + 107424) = 0;
  pthread_mutex_unlock((pthread_mutex_t *)(v6 + 106056));
  if ( !*(_DWORD *)(v6 + 107416) )
  {
    v11 = *(_DWORD *)(v6 + 105460);
    if ( v11 == 1 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] jpeg abort", "mm_jpeg_session_configure", 1471);
LABEL_15:
      *(_DWORD *)(v6 + 107416) = 1;
      goto LABEL_16;
    }
    if ( j_mm_jpeg_session_config_main(v6, v11, v9, v10) )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] config main img failed", "mm_jpeg_session_configure", 1476);
    }
    else
    {
      v13 = j_mm_jpeg_session_change_state(v6, 2, mm_jpeg_session_send_buffers, v12);
      if ( v13 )
      {
        v15 = "mm-jpeg-intf";
        v51 = v13;
        v16 = "%s:%d] change state to idle failed %d";
        v46 = 1483;
        v17 = "mm_jpeg_session_configure";
      }
      else
      {
        v18 = j_mm_jpeg_session_change_state(v6, 3, 0, v14);
        if ( !v18 )
          goto LABEL_15;
        v46 = 1491;
        v15 = "mm-jpeg-intf";
        v17 = "mm_jpeg_session_configure";
        v51 = v18;
        v16 = "%s:%d] change state to executing failed %d";
      }
      _android_log_print(6, v15, v16, v17, v46, v51);
    }
    v35 = "mm-jpeg-intf";
    v49 = 1558;
    v34 = "%s:%d] Error";
    v36 = "mm_jpeg_session_encode";
LABEL_44:
    _android_log_print(6, v35, v34, v36, v49);
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] encode session failed", "mm_jpeg_process_encoding_job", 1654);
    v43 = *(void (__cdecl **)(signed int))(v6 + 20816);
    if ( v43 )
    {
      *(_DWORD *)(v6 + 105448) = 1;
      v44 = *(_DWORD *)(v6 + 20820);
      v45 = *(_DWORD *)v6;
      v43(1);
    }
    goto LABEL_49;
  }
LABEL_16:
  if ( j_mm_jpeg_session_config_common(v6) )
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] config common failed", "mm_jpeg_configure_job_params", 1387);
  v19 = j_mm_jpeg_session_config_main_crop(v6);
  if ( !v19 )
  {
    memset(&s, 0, 0x10u);
    v23 = *(_DWORD *)(v6 + 105464);
    v57 = *(_DWORD *)(v6 + 20768);
    v24 = (*(int (**)(void))(v23 + 36))();
    v19 = v24;
    if ( v24 )
    {
      v47 = 1406;
      v52 = v24;
      v25 = "mm-jpeg-intf";
      v26 = "%s:%d] Error setting Q factor %d";
      v27 = "mm_jpeg_configure_job_params";
LABEL_26:
      _android_log_print(6, v25, v26, v27, v47, v52);
      goto LABEL_33;
    }
    v19 = j_mm_jpeg_session_config_thumbnail(v6);
    if ( v19 )
    {
      v48 = 1413;
      v28 = "mm-jpeg-intf";
      v29 = "%s:%d] config thumbnail img failed";
      v30 = "mm_jpeg_configure_job_params";
    }
    else
    {
      memset(&v53, 0, 0xCu);
      v31 = (*(int (**)(void))(*(_DWORD *)(v6 + 105464) + 40))();
      v19 = v31;
      if ( v31 )
      {
        v47 = 1425;
        v52 = v31;
        v25 = "mm-jpeg-intf";
        v26 = "%s:%d] Error getting work buffer index %d";
        v27 = "mm_jpeg_configure_job_params";
        goto LABEL_26;
      }
      v32 = *(_DWORD *)(v6 + 107456);
      v33 = *(_DWORD *)(v6 + 107460);
      v54 = *(_DWORD *)(v6 + 107468);
      v53 = v32;
      v55 = v33;
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] Work buffer %d %p WorkBufSize %d",
        "mm_jpeg_configure_job_params",
        1432,
        v32,
        v54,
        v33);
      v19 = (*(int (**)(void))(*(_DWORD *)(v6 + 105464) + 36))();
      if ( !v19 )
      {
        v19 = j_mm_jpeg_metadata(v6);
        if ( !v19 )
          goto LABEL_35;
        v20 = "mm-jpeg-intf";
        v22 = "mm_jpeg_configure_job_params";
        v21 = "%s: set metdata failed";
        goto LABEL_32;
      }
      v48 = 1437;
      v29 = "%s:%d] Error";
      v28 = "mm-jpeg-intf";
      v30 = "mm_jpeg_configure_job_params";
    }
    _android_log_print(6, v28, v29, v30, v48);
    goto LABEL_33;
  }
  v20 = "mm-jpeg-intf";
  v21 = "%s: config crop failed";
  v22 = "mm_jpeg_configure_job_params";
LABEL_32:
  _android_log_print(6, v20, v21, v22);
LABEL_33:
  if ( v19 )
  {
    v49 = 1566;
    v34 = "%s:%d] Error";
    v35 = "mm-jpeg-intf";
    v36 = "mm_jpeg_session_encode";
    goto LABEL_44;
  }
LABEL_35:
  pthread_mutex_lock((pthread_mutex_t *)(v6 + 106056));
  *(_DWORD *)(v6 + 107424) = 1;
  pthread_mutex_unlock((pthread_mutex_t *)(v6 + 106056));
  if ( *(_DWORD *)(v6 + 105460) == 1 )
  {
    v37 = "mm-jpeg-intf";
    v50 = 1573;
    v38 = "%s:%d] jpeg abort";
    v39 = "mm_jpeg_session_encode";
LABEL_48:
    _android_log_print(6, v37, v38, v39, v50);
    return 0;
  }
  v40 = *(_DWORD *)(v6 + 4 * (*(_DWORD *)(v6 + 20824) + 26370));
  if ( (*(int (**)(void))(*(_DWORD *)(v6 + 105464) + 64))() )
  {
    v35 = "mm-jpeg-intf";
    v49 = 1586;
    v34 = "%s:%d] Error";
    v36 = "mm_jpeg_session_encode";
    goto LABEL_44;
  }
  if ( *(_BYTE *)(v6 + 24) )
  {
    v41 = *(_DWORD *)(v6 + 4 * (*(_DWORD *)(v6 + 20832) + 26394));
    if ( (*(int (**)(void))(*(_DWORD *)(v6 + 105464) + 64))() )
    {
      v49 = 1594;
      v35 = "mm-jpeg-intf";
      v34 = "%s:%d] Error";
      v36 = "mm_jpeg_session_encode";
      goto LABEL_44;
    }
  }
  v42 = *(_DWORD *)(v6 + 4 * (*(_DWORD *)(v6 + 20828) + 26418));
  if ( (*(int (**)(void))(*(_DWORD *)(v6 + 105464) + 68))() )
  {
    v35 = "mm-jpeg-intf";
    v34 = "%s:%d] Error";
    v49 = 1602;
    v36 = "mm_jpeg_session_encode";
    goto LABEL_44;
  }
  if ( *(_DWORD *)(v6 + 105460) == 1 )
  {
    v37 = "mm-jpeg-intf";
    v38 = "%s:%d] jpeg abort";
    v50 = 1606;
    v39 = "mm_jpeg_session_encode";
    goto LABEL_48;
  }
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (00004478) --------------------------------------------------------
int __fastcall sub_4478(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r5@1
  pthread_cond_t *v4; // r8@1
  int v5; // r4@2
  int v6; // r0@5
  int *v7; // r0@6
  char *v8; // r0@7
  void *v9; // r0@9
  int v11; // [sp+4h] [bp-1Ch]@1

  v11 = a2;
  v2 = a1;
  v3 = a1 + 8597868;
  v4 = (pthread_cond_t *)(a1 + 8597876);
  do
  {
    while ( 1 )
    {
      v5 = 0;
      pthread_mutex_lock((pthread_mutex_t *)(v3 + 4));
      while ( !*(_DWORD *)v3 )
        v5 = pthread_cond_wait(v4, (pthread_mutex_t *)(v3 + 4));
      --*(_DWORD *)v3;
      v6 = pthread_mutex_unlock((pthread_mutex_t *)(v3 + 4));
      if ( v5 )
        break;
      if ( !j_mm_jpeg_queue_get_size(v2 + 8597900) )
      {
        pthread_mutex_lock((pthread_mutex_t *)(v2 + 8597860));
        v9 = (void *)j_mm_jpeg_queue_deq(v2 + 8597880);
        if ( !v9 )
          goto LABEL_13;
        if ( !*(_DWORD *)v9 )
        {
          j_mm_jpeg_process_encoding_job(v2, (int)v9, 0);
LABEL_13:
          v5 = 1;
          goto LABEL_14;
        }
        free(v9);
LABEL_14:
        pthread_mutex_unlock((pthread_mutex_t *)(v2 + 8597860));
        if ( !v5 )
          return 0;
      }
    }
    v7 = (int *)_errno(v6);
  }
  while ( *v7 == 22 );
  v8 = strerror(*v7);
  _android_log_print(6, "mm-jpeg-intf", "%s: cam_sem_wait error (%s)", "mm_jpeg_jobmgr_thread", v8, v11);
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 18E0: using guessed type int __fastcall _errno(_DWORD);

//----- (00004538) --------------------------------------------------------
int __fastcall mm_jpeg_fbd(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r4@1
  void (__cdecl *v6)(_DWORD); // r6@2
  int v7; // r3@3
  int v8; // r1@3
  int v9; // r7@3
  int v10; // r1@3
  int v12; // [sp+Ch] [bp-24h]@3
  int v13; // [sp+10h] [bp-20h]@3
  int v14; // [sp+14h] [bp-1Ch]@3

  v3 = a2 + 107008;
  v4 = a3;
  v5 = a2;
  _android_log_print(6, "mm-jpeg-intf", "%s:%d] count %d ", "mm_jpeg_fbd", 2377, *(_DWORD *)(a2 + 107408));
  _android_log_print(6, "mm-jpeg-intf", "[KPI Perf] : PROFILE_JPEG_FBD");
  pthread_mutex_lock((pthread_mutex_t *)(v5 + 106056));
  if ( !*(_DWORD *)(v5 + 105460) )
  {
    ++*(_DWORD *)(v3 + 400);
    v6 = *(void (__cdecl **)(_DWORD))(v5 + 20816);
    if ( v6 )
    {
      *(_DWORD *)(v5 + 105448) = 0;
      v7 = *(_DWORD *)(v4 + 16);
      v8 = *(_DWORD *)(v5 + 20820);
      v9 = *(_DWORD *)(v4 + 8);
      v14 = v7;
      v13 = 0;
      v12 = v9;
      v10 = *(_DWORD *)v5;
      v6(0);
      sub_3F38(v5);
    }
  }
  pthread_mutex_unlock((pthread_mutex_t *)(v5 + 106056));
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000045DC) --------------------------------------------------------
int __fastcall mm_jpeg_event_handler(int a1, int a2, int a3)
{
  int v3; // r5@1
  pthread_mutex_t *v4; // r6@1
  int v5; // r4@1
  int v6; // r7@1
  void (__cdecl *v7)(signed int, _DWORD, _DWORD); // r7@5
  int v8; // ST00_4@6

  v3 = a2 + 105984;
  v4 = (pthread_mutex_t *)(a2 + 106056);
  v5 = a2;
  v6 = a3;
  pthread_mutex_lock((pthread_mutex_t *)(a2 + 106056));
  if ( *(_DWORD *)(v5 + 105460) == 1 )
  {
    *(_DWORD *)(v5 + 105460) = 2;
LABEL_11:
    pthread_cond_signal((pthread_cond_t *)(v3 + 76));
    goto LABEL_12;
  }
  if ( v6 == 1 )
  {
    *(_DWORD *)(v5 + 105456) = -2147479543;
    if ( *(_DWORD *)(v5 + 107424) == 1 )
    {
      v7 = *(void (__cdecl **)(signed int, _DWORD, _DWORD))(v5 + 20816);
      if ( v7 )
      {
        *(_DWORD *)(v5 + 105448) = 1;
        v8 = *(_DWORD *)(v5 + 20820);
        v7(1, *(_DWORD *)v5, *(_DWORD *)(v5 + 4));
      }
      sub_3F38(v5);
    }
    goto LABEL_11;
  }
  if ( !v6 && *(_DWORD *)(v5 + 105452) == 1 )
  {
    *(_DWORD *)(v5 + 105452) = 0;
    goto LABEL_11;
  }
LABEL_12:
  pthread_mutex_unlock(v4);
  return 0;
}

//----- (00004668) --------------------------------------------------------
signed int __fastcall mm_jpeg_abort_job(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r6@1
  pthread_mutex_t *v5; // r4@1
  void *v6; // r0@1
  int v7; // r0@2
  int v8; // r2@2
  void *v9; // r6@2
  int v10; // r7@3
  int v11; // r0@3
  int v13; // [sp+8h] [bp-18h]@1

  v13 = a3;
  v3 = a1;
  v4 = a2;
  v5 = (pthread_mutex_t *)(a1 + 8597860);
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 8597860));
  v6 = (void *)j_mm_jpeg_queue_remove_job_by_job_id(v3 + 8597880, v4);
  if ( v6 )
  {
LABEL_7:
    free(v6);
    goto LABEL_8;
  }
  v7 = j_mm_jpeg_queue_remove_job_by_job_id(v3 + 8597900, v4);
  v9 = (void *)v7;
  if ( v7 )
  {
    v10 = v7 + 84480;
    v11 = mm_jpeg_get_session(v3, *(_DWORD *)(v7 + 84620), v8);
    if ( v11 )
      j_mm_jpeg_session_abort(v11);
    else
      _android_log_print(
        6,
        "mm-jpeg-intf",
        "%s:%d] Invalid job id 0x%x",
        "mm_jpeg_abort_job",
        2087,
        *(_DWORD *)(v10 + 140),
        v13);
    v6 = v9;
    goto LABEL_7;
  }
LABEL_8:
  pthread_mutex_unlock(v5);
  return -1;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);

//----- (000046F4) --------------------------------------------------------
int __fastcall mm_jpeg_queue_remove_job_unlk(int a1, int a2)
{
  _DWORD *i; // r3@1
  int v3; // r4@3
  _DWORD *v4; // r2@5

  for ( i = *(_DWORD **)a1; i != (_DWORD *)a1; i = (_DWORD *)*i )
  {
    v3 = i[2];
    if ( v3 && *(_DWORD *)(v3 + 84620) == a2 )
    {
      v4 = (_DWORD *)i[1];
      *(_DWORD *)(*i + 4) = v4;
      *v4 = *i;
      *i = i;
      i[1] = i;
      --*(_DWORD *)(a1 + 12);
      free(i);
      return v3;
    }
  }
  return 0;
}

//----- (00004734) --------------------------------------------------------
signed int __fastcall sub_4734(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r2@3
  signed int v5; // r0@6
  int v6; // r2@6
  int v7; // r3@6
  int v8; // r1@6
  int v9; // r4@6
  int v10; // [sp+4h] [bp-14h]@1

  v10 = a2;
  v2 = a1;
  if ( !a1 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid client_hdl", "mm_jpeg_intf_close", 249, a2);
    return -1;
  }
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( !dword_A00C )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] mm_jpeg is not opened yet", "mm_jpeg_intf_close", 256, v10);
    pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
    return -1;
  }
  v5 = j_mm_jpeg_close(dword_A00C, v2, v3);
  v7 = dword_A00C;
  v8 = (*(_DWORD *)dword_A00C)--;
  v9 = v5;
  if ( !v5 && v8 == 1 )
  {
    v9 = j_mm_jpeg_deinit(v7, 1, v6, v7);
    free((void *)dword_A00C);
    dword_A00C = 0;
  }
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
  return v9;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (000047E0) --------------------------------------------------------
signed int __fastcall sub_47E0(int a1, int a2, int a3)
{
  unsigned __int16 v3; // r4@1
  int v4; // r2@3
  int v6; // r4@6
  int v7; // [sp+4h] [bp-14h]@1
  int v8; // [sp+8h] [bp-10h]@1

  v7 = a2;
  v8 = a3;
  v3 = a1;
  if ( !a1 )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] invalid client_hdl or jobId",
      "mm_jpeg_intf_destroy_session",
      181,
      a2,
      a3);
    return -1;
  }
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( !dword_A00C )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] mm_jpeg is not opened yet",
      "mm_jpeg_intf_destroy_session",
      188,
      v7,
      v8);
    pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
    return -1;
  }
  v6 = j_mm_jpeg_destroy_session_by_id(dword_A00C, v3, v4);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
  return v6;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (00004868) --------------------------------------------------------
signed int __fastcall sub_4868(int a1, int a2, unsigned int *a3)
{
  int v3; // r6@1
  unsigned int *v4; // r4@1
  int v5; // r7@1
  int v7; // r6@8
  int v8; // [sp+4h] [bp-1Ch]@1
  unsigned int *v9; // [sp+8h] [bp-18h]@1

  v8 = a2;
  v9 = a3;
  v3 = a2;
  v4 = a3;
  v5 = a1;
  if ( !a1 || !a2 || !a3 )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] invalid client_hdl or jobId",
      "mm_jpeg_intf_create_session",
      147,
      a2,
      a3);
    return -1;
  }
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( !dword_A00C )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] mm_jpeg is not opened yet",
      "mm_jpeg_intf_create_session",
      154,
      v8,
      v9);
    pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
    return -1;
  }
  v7 = j_mm_jpeg_create_session(dword_A00C, v5, v3, v4);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
  return v7;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (000048FC) --------------------------------------------------------
signed int __fastcall sub_48FC(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r2@3
  signed int v6; // r4@6
  int v7; // [sp+4h] [bp-14h]@1
  int v8; // [sp+8h] [bp-10h]@1

  v7 = a2;
  v8 = a3;
  v3 = a1;
  if ( !a1 )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] invalid jobId", "mm_jpeg_intf_abort_job", 215, a2, a3);
    return -1;
  }
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( !dword_A00C )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] mm_jpeg is not opened yet", "mm_jpeg_intf_abort_job", 222, v7, v8);
    pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
    return -1;
  }
  v6 = j_mm_jpeg_abort_job(dword_A00C, v3, v4);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
  return v6;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (00004984) --------------------------------------------------------
signed int __fastcall sub_4984(int a1, int *a2)
{
  int *v2; // r4@1
  int v3; // r6@1
  signed int v5; // r4@7
  int *v6; // [sp+4h] [bp-14h]@1

  v6 = a2;
  v2 = a2;
  v3 = a1;
  if ( !a1 || !a2 )
  {
    _android_log_print(
      6,
      "mm-jpeg-intf",
      "%s:%d] invalid parameters for job or jobId",
      "mm_jpeg_intf_start_job",
      110,
      a2);
    return -1;
  }
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( !dword_A00C )
  {
    _android_log_print(6, "mm-jpeg-intf", "%s:%d] mm_jpeg is not opened yet", "mm_jpeg_intf_start_job", 117, v6);
    pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
    return -1;
  }
  v5 = j_mm_jpeg_start_job(dword_A00C, v3, v2);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
  return v5;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (00004A10) --------------------------------------------------------
int __fastcall mm_jpeg_util_generate_handler(int a1)
{
  int v1; // r4@1
  int v2; // r4@4

  v1 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_A010);
  if ( word_A008 == -1 )
    word_A008 += 2;
  else
    ++word_A008;
  v2 = v1 | ((unsigned __int16)word_A008 << 8);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_A010);
  return v2;
}
// A008: using guessed type __int16 word_A008;

//----- (00004A5C) --------------------------------------------------------
int __fastcall mm_jpeg_util_get_index_by_handler(int result)
{
  return (unsigned __int8)result;
}

//----- (00004A60) --------------------------------------------------------
void *__fastcall jpeg_open(int a1, int a2)
{
  int v2; // r6@1
  void *v3; // r0@2
  void *v4; // r4@2
  pthread_mutex_t *v5; // r0@3
  int v6; // r1@4
  int v7; // r0@4
  int v9; // r2@10
  int v10; // r3@10
  int v11; // [sp+4h] [bp-1Ch]@1

  v11 = a2;
  v2 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_A004);
  if ( dword_A00C )
  {
LABEL_7:
    v4 = (void *)j_mm_jpeg_new_client((char *)dword_A00C);
    if ( v4 )
    {
      if ( v2 )
      {
        *(_DWORD *)v2 = sub_4984;
        *(_DWORD *)(v2 + 4) = sub_48FC;
        *(_DWORD *)(v2 + 8) = sub_4868;
        *(_DWORD *)(v2 + 12) = sub_47E0;
        *(_DWORD *)(v2 + 16) = sub_4734;
      }
    }
    else
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] mm_jpeg_new_client failed", "jpeg_open", 332, v11);
      if ( !*(_DWORD *)dword_A00C )
      {
        j_mm_jpeg_deinit(dword_A00C, 0, v9, v10);
        free((void *)dword_A00C);
        dword_A00C = 0;
      }
    }
    v5 = (pthread_mutex_t *)&unk_A004;
    goto LABEL_13;
  }
  v3 = malloc(0x8331CCu);
  v4 = v3;
  if ( v3 )
  {
    memset(v3, 0, 0x8331CCu);
    v7 = j_mm_jpeg_init((int)v4, v6);
    if ( v7 )
    {
      _android_log_print(6, "mm-jpeg-intf", "%s:%d] mm_jpeg_init err = %d", "jpeg_open", 308, v7);
      free(v4);
      pthread_mutex_unlock((pthread_mutex_t *)&unk_A004);
      return 0;
    }
    dword_A00C = (int)v4;
    goto LABEL_7;
  }
  _android_log_print(6, "mm-jpeg-intf", "%s:%d] no mem", "jpeg_open", 299, v11);
  v5 = (pthread_mutex_t *)&unk_A004;
LABEL_13:
  pthread_mutex_unlock(v5);
  return v4;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// A00C: using guessed type int dword_A00C;

//----- (00004B98) --------------------------------------------------------
void *__fastcall buffer_allocate(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r0@5
  int *v5; // r0@6
  char *v6; // r0@6
  int v7; // r3@7
  void *result; // r0@7
  int *v9; // r0@8
  int *v10; // r5@8
  char *v11; // r0@8
  int v12; // r0@9
  int v13; // [sp+Ch] [bp-14h]@9

  v2 = a1;
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
  *(_DWORD *)(a1 + 12) = 4096;
  *(_DWORD *)(a1 + 20) = a2 != 0;
  *(_DWORD *)(a1 + 16) = 0x2000000;
  v3 = open("/dev/ion", 0);
  *(_DWORD *)(v2 + 36) = v3;
  if ( v3 >= 0 )
  {
    *(_DWORD *)(v2 + 8) = (*(_DWORD *)(v2 + 8) + 4095) & 0xFFFFF000;
    if ( ioctl(v3, 0xC0144900, v2 + 8) >= 0 )
    {
      *(_DWORD *)v2 = *(_DWORD *)(v2 + 24);
      v4 = ioctl(*(_DWORD *)(v2 + 36), 0xC0084904, v2);
      if ( v4 >= 0 )
      {
        v7 = *(_DWORD *)(v2 + 4);
        *(_DWORD *)(v2 + 28) = v7;
        result = mmap(0, *(_DWORD *)(v2 + 8), 3, 1, v7, 0);
        if ( result != (void *)-1 )
          return result;
        v9 = (int *)_errno(-1);
        v10 = v9;
        v11 = strerror(*v9);
        _android_log_print(6, "mm-jpeg-intf", "%s :ION_MMAP_FAILED: %s (%d)", "buffer_allocate", v11, *v10);
      }
      else
      {
        v5 = (int *)_errno(v4);
        v6 = strerror(*v5);
        _android_log_print(6, "mm-jpeg-intf", "%s :ION map failed %s", "buffer_allocate", v6);
      }
      v12 = *(_DWORD *)(v2 + 36);
      v13 = *(_DWORD *)v2;
      ioctl(v12, 0xC0044901, &v13);
    }
    else
    {
      _android_log_print(6, "mm-jpeg-intf", "%s :ION allocation failed len %d", "buffer_allocate", *(_DWORD *)(v2 + 8));
    }
  }
  else
  {
    _android_log_print(6, "mm-jpeg-intf", "%s :Ion open failed", "buffer_allocate");
  }
  return 0;
}
// 1688: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 18E0: using guessed type int __fastcall _errno(_DWORD);

//----- (00004CD4) --------------------------------------------------------
int __fastcall buffer_deallocate(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r5@1
  int v6; // [sp+4h] [bp-14h]@1
  int v7; // [sp+8h] [bp-10h]@1

  v6 = a2;
  v7 = a3;
  v3 = a1;
  v4 = munmap(*(void **)(a1 + 40), (*(_DWORD *)(a1 + 32) + 4095) & 0xFFFFF000);
  close(*(_DWORD *)(v3 + 4));
  v6 = *(_DWORD *)v3;
  ioctl(*(_DWORD *)(v3 + 36), 0xC0044901, &v6);
  close(*(_DWORD *)(v3 + 36));
  return v4;
}

//----- (00004D14) --------------------------------------------------------
signed int __fastcall sub_4D14(int a1, int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // r5@1
  unsigned int v5; // r7@1
  int v6; // r10@1
  int v7; // r4@1
  int v8; // r11@2
  unsigned int v9; // r8@7
  int v10; // r9@7
  int v11; // r0@8
  int v12; // r2@9
  int v13; // r1@10
  signed int result; // r0@10
  int v15; // r3@19
  int v16; // r2@19
  int v17; // r0@19
  int v18; // r1@19
  int v19; // r2@37
  int v20; // r0@39
  int v21; // r1@39
  int v22; // r3@39
  unsigned int v23; // r1@40
  unsigned int v24; // r0@40
  int v25; // r1@42
  int v26; // r6@45
  char v27; // r1@45
  int v29; // r0@50
  unsigned int v35; // r0@51
  int v36; // [sp+4h] [bp-34h]@58
  int v37; // [sp+8h] [bp-30h]@6
  int v38; // [sp+Ch] [bp-2Ch]@22
  int v39; // [sp+10h] [bp-28h]@8

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  if ( a3 >= a4 )
    goto LABEL_58;
  v8 = 0;
  do
  {
    v9 = v5 + 1;
    v10 = *(_BYTE *)(v6 + (v5 ^ 3));
    if ( !(v10 & 0x80) )
    {
      sub_5590(v7, 13, &v39);
      v11 = 4 * v10;
      if ( v10 & 0x40 )
        v12 = -4 - (v11 & 0xFC) + v39;
      else
        v12 = v11 + v39 + 4;
      v39 = v12;
LABEL_23:
      sub_55C0(v7, 13, v12);
      ++v5;
      continue;
    }
    v13 = v10 & 0xF0;
    result = 9;
    if ( v13 > 159 )
    {
      if ( v13 > 191 )
      {
        if ( v13 == 192 )
        {
          switch ( v10 )
          {
            case 199:
              if ( !*(_BYTE *)(v6 + (v9 ^ 3)) || (unsigned int)*(_BYTE *)(v6 + (v9 ^ 3)) >= 0x10 )
                return 9;
              goto LABEL_55;
            case 192:
            case 193:
            case 194:
            case 195:
            case 196:
            case 197:
              v18 = 3;
              v16 = ((v10 & 7) + 1) | 0xA0000;
              v17 = v7;
              goto LABEL_33;
            case 200:
            case 201:
              v23 = *(_BYTE *)(v6 + (v9 ^ 3));
              v24 = v23 >> 4;
              if ( v10 == 200 )
                v24 = (v23 >> 4) | 0x10;
              v25 = v23 & 0xF;
              if ( (signed int)(v24 + v25) > 31 )
                return 9;
              v19 = (v25 + 1) | (v24 << 16);
              v20 = v7;
              v21 = 1;
              goto LABEL_53;
            case 198:
              v35 = *(_BYTE *)(v6 + (v9 ^ 3));
              if ( (signed int)((v35 & 0xF) + (v35 >> 4)) > 15 )
                return 9;
              v19 = ((v35 & 0xF) + 1) | (v35 >> 4 << 16);
              v20 = v7;
              v21 = 3;
LABEL_53:
              v22 = 5;
LABEL_54:
              sub_50F8(v20, v21, v19, v22);
              goto LABEL_55;
            default:
              return 9;
          }
          return 9;
        }
        if ( v13 != 208 )
          return result;
        if ( v10 & 8 )
          return 9;
        v18 = 1;
        v16 = ((v10 & 7) + 1) | 0x80000;
        v17 = v7;
LABEL_33:
        v15 = 5;
      }
      else
      {
        if ( v13 != 160 )
        {
          if ( v13 != 176 )
            return result;
          result = 9;
          switch ( v10 )
          {
            case 177:
              if ( v9 >= v4 )
                return 9;
              v19 = *(_BYTE *)(v6 + (v9 ^ 3));
              result = 9;
              if ( !*(_BYTE *)(v6 + (v9 ^ 3)) || v19 & 0xF0 )
                return result;
              v20 = v7;
              v21 = 0;
              v22 = 0;
              goto LABEL_54;
            case 178:
              if ( v9 >= v4 )
                return 9;
              v5 += 2;
              v26 = 0;
              v27 = 0;
              break;
            case 179:
              v22 = 1;
              v29 = *(_BYTE *)(v6 + (v9 ^ 3));
              _R1 = v29 << 12;
              __asm { UXTB16.W        R1, R1 }
              v19 = ((v29 & 0xF) + 1) | _R1;
              v20 = v7;
              v21 = 1;
              goto LABEL_54;
            case 176:
              goto LABEL_57;
            case 180:
            case 181:
            case 182:
            case 183:
              return result;
            default:
              v18 = 1;
              v15 = 1;
              v16 = ((v10 & 7) + 1) | 0x80000;
              v17 = v7;
              goto LABEL_34;
          }
          while ( 1 )
          {
            v26 |= (*(_BYTE *)(v6 + ((v5 - 1) ^ 3)) & 0x7F) << v27;
            if ( !(*(_BYTE *)(v6 + ((v5 - 1) ^ 3)) & 0x80) )
              break;
            v27 += 7;
            _CF = v5 >= v4;
            result = 9;
            ++v5;
            if ( _CF )
              return result;
          }
          sub_5590(v7, 13, &v37);
          v37 += 4 * v26 + 516;
          sub_55C0(v7, 13, v37);
          continue;
        }
        v15 = 0;
        v16 = ((16 << ((*(_BYTE *)(v6 + (v5 ^ 3)) & 7) + 1)) - 16) | (*(_BYTE *)(v6 + (v5 ^ 3)) << 11) & 0x4000;
        v17 = v7;
        v18 = 0;
      }
LABEL_34:
      sub_50F8(v17, v18, v16, v15);
      ++v5;
      continue;
    }
    if ( v13 != 128 )
    {
      if ( v13 != 144 )
        return result;
      if ( (v10 & 0xF | 2) == 15 )
        return 9;
      sub_5590(v7, v10 & 0xF, &v38);
      v12 = v38;
      goto LABEL_23;
    }
    if ( v9 >= v4 || !((unsigned __int16)((_WORD)v10 << 12) | 16 * *(_BYTE *)(v6 + ((v5 + 1) ^ 3))) )
      return 9;
    sub_50F8(v7, 0, (unsigned __int16)((_WORD)v10 << 12) | 16 * *(_BYTE *)(v6 + (v9 ^ 3)), 0);
    v8 |= (((_WORD)v10 << 12) & 0x8000u) >> 15;
LABEL_55:
    v5 += 2;
  }
  while ( v5 < v4 );
LABEL_57:
  if ( v8 & 1 )
    return 8;
LABEL_58:
  sub_5590(v7, 14, &v36);
  sub_55C0(v7, 15, v36);
  return 8;
}

//----- (00005054) --------------------------------------------------------
signed int __fastcall sub_5054(int a1, int a2, unsigned int a3, int a4, int *a5)
{
  int v5; // r5@1
  int v6; // r4@1
  signed int result; // r0@2
  int v8; // r2@4
  int v9; // r0@4
  int v10; // r1@4
  __int64 v11; // r2@10
  int v12; // r1@10

  v5 = a3;
  v6 = a1;
  switch ( a2 )
  {
    case 0:
      result = 2;
      if ( a3 > 0xF || a4 )
        return result;
      v8 = *a5;
      v9 = v6;
      v10 = v5;
      goto LABEL_14;
    case 1:
      if ( a4 == 5 )
      {
        if ( a3 <= 0x1F )
          goto LABEL_21;
        return 2;
      }
      if ( a4 != 1 || a3 > 0xF )
        return 2;
      sub_56AC(a1);
LABEL_21:
      v11 = *(_QWORD *)a5;
      v12 = v5 + 256;
LABEL_22:
      result = sub_5634(v6, v12, v11, SHIDWORD(v11));
LABEL_23:
      if ( result )
        result = 2;
      return result;
    case 3:
      result = 2;
      if ( a3 > 0x1F || a4 != 5 )
        return result;
      v11 = *(_QWORD *)a5;
      v12 = v5 + 112;
      goto LABEL_22;
    case 4:
      result = 2;
      if ( a3 > 3 || a4 )
        return result;
      v8 = *a5;
      v10 = v5 + 192;
      v9 = v6;
LABEL_14:
      result = sub_55C0(v9, v10, v8);
      goto LABEL_23;
    default:
      sub_5434(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Set(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepre"
             "sentation, void *)",
        831,
        (int)"unsupported register class");
      return result;
  }
}

//----- (000050F8) --------------------------------------------------------
signed int __fastcall sub_50F8(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // r5@1
  int v5; // r7@1
  unsigned int v6; // r6@1
  int v7; // r8@1
  int v8; // r4@4
  unsigned int v9; // r7@4
  int *v10; // r0@6
  signed int v11; // r0@6
  signed int v12; // r1@6
  signed int v13; // r2@6
  signed int result; // r0@14
  unsigned int v15; // r4@18
  unsigned int v16; // r6@18
  int v17; // r0@19
  int v18; // r2@19
  int v19; // r2@22
  int v20; // [sp+8h] [bp-38h]@19
  int v21; // [sp+Ch] [bp-34h]@19
  int v22; // [sp+14h] [bp-2Ch]@16
  int v23; // [sp+18h] [bp-28h]@6
  int *v24; // [sp+1Ch] [bp-24h]@3

  v4 = a2;
  v5 = a4;
  v6 = a3;
  v7 = a1;
  switch ( a2 )
  {
    case 0:
    case 4:
      if ( a4 || sub_5590(a1, 13, &v24) )
        return 2;
      v8 = 0;
      v9 = 0;
      do
      {
        if ( (1 << v9) & v6 )
        {
          v10 = v24;
          ++v24;
          v23 = *v10;
          v11 = sub_5054(v7, v4, v9, 0, &v23);
          v12 = 0;
          v13 = 0;
          if ( v9 == 13 )
            v12 = 1;
          if ( !v4 )
            v13 = 1;
          if ( v11 )
            return 2;
          v8 |= v13 & v12;
        }
        ++v9;
      }
      while ( v9 < 0x10 );
      if ( v8 & 1 )
        return 0;
      v19 = (int)v24;
      goto LABEL_28;
    case 1:
    case 3:
      if ( (a4 | 4) != 5 || sub_5590(a1, 13, &v22) )
        return 2;
      if ( !(_WORD)v6 )
        goto LABEL_21;
      v15 = v6 >> 16;
      v16 = (v6 >> 16) + v6;
      break;
    default:
      sub_5434(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Pop(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepresentation)",
        965,
        (int)"unsupported register class");
      return result;
  }
  do
  {
    v17 = v22;
    v22 += 4;
    v18 = *(_DWORD *)v17;
    v22 = v17 + 8;
    v21 = *(_DWORD *)(v17 + 4);
    v20 = v18;
    if ( sub_5054(v7, v4, v15, v5, &v20) )
      return 2;
    ++v15;
  }
  while ( v15 < v16 );
LABEL_21:
  if ( v5 == 1 )
  {
    v19 = v22 + 4;
    v22 += 4;
  }
  else
  {
    v19 = v22;
  }
LABEL_28:
  result = sub_55C0(v7, 13, v19);
  if ( result )
    result = 2;
  return result;
}

//----- (00005220) --------------------------------------------------------
signed int __fastcall sub_5220(int a1, int a2, int a3)
{
  int v3; // r0@1
  int v4; // r1@1
  unsigned int *v5; // r12@1
  int v6; // r3@1
  bool v7; // zf@2
  unsigned int v8; // r3@6
  unsigned int v9; // r2@6

  v3 = a2;
  v4 = a3;
  v5 = *(unsigned int **)(v3 + 76);
  v6 = (*v5 >> 24) & 0xF;
  if ( v6 )
  {
    v7 = v6 == 1;
    if ( v6 != 1 )
      v7 = v6 == 3;
    if ( !v7 )
      return 9;
    v8 = 4 * ((*v5 >> 16) & 0xFF) + 4;
    v9 = 2;
  }
  else
  {
    v9 = 1;
    v8 = 4;
  }
  if ( !v5 || !(*(_BYTE *)(v3 + 80) & 1) && *(unsigned int *)((char *)v5 + v8) )
    return 9;
  return sub_4D14(v4, (int)v5, v9, v8);
}

//----- (00005274) --------------------------------------------------------
void sub_5274()
{
  JUMPOUT(&loc_5228);
}

//----- (0000527C) --------------------------------------------------------
void sub_527C()
{
  JUMPOUT(&loc_5228);
}

//----- (00005318) --------------------------------------------------------
signed int __fastcall sub_5318(int a1, int a2, char a3)
{
  int v3; // r4@1
  char v4; // r10@1
  signed int i; // r6@1
  signed int v6; // r7@3
  int v7; // r0@8
  int (__fastcall *v8)(signed int, int, char *); // r3@11
  int v9; // r0@12
  int v11; // [sp+0h] [bp-4B0h]@17
  int v12; // [sp+4h] [bp-4ACh]@10
  int (__fastcall *v13)(signed int, int, char *); // [sp+10h] [bp-4A0h]@11
  int v14; // [sp+18h] [bp-498h]@12
  int v15; // [sp+24h] [bp-48Ch]@12
  int v16; // [sp+2Ch] [bp-484h]@10
  char v17; // [sp+30h] [bp-480h]@1

  v3 = a2;
  v4 = a3;
  sub_5540((int)&v17);
  for ( i = 1; ; --i )
  {
    v6 = 1;
    if ( v4 & 1 )
    {
      v6 = 2;
      if ( !i )
      {
        sub_55C0((int)&v17, -1, *(_DWORD *)(v3 + 16));
        v4 = 0;
      }
    }
    v7 = sub_566C((int)&v17);
    if ( !v7 )
      break;
    if ( v7 < 0 )
      return 2;
    sub_5590((int)&v17, -2, &v16);
    if ( sub_5674((int)&v17, (int)&v12) )
      return 2;
    v8 = v13;
    if ( v13 )
    {
      *(_DWORD *)(v3 + 72) = v12;
      *(_DWORD *)(v3 + 76) = v15;
      *(_DWORD *)(v3 + 80) = v14;
      v9 = v8(v6, v3, &v17);
      if ( v9 == 7 )
      {
        sub_5590((int)&v17, -1, &v11);
        *(_DWORD *)(v3 + 16) = v11;
        sub_5694((int)&v17);
        return 2;
      }
      if ( v9 == 9 )
        abort();
      if ( v9 != 8 )
        return 2;
      if ( v16 == *(_DWORD *)(v3 + 32) )
        sub_5434(
          (int)"_Unwind_Reason_Code unwind_phase2(unw_context_t *, _Unwind_Exception *, bool)",
          642,
          (int)"during phase1 personality function said it would stop here, but now in phase2 it did not stop here");
    }
  }
  return 5;
}

//----- (00005434) --------------------------------------------------------
void __fastcall sub_5434(int a1, int a2, int a3)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, "external/libcxxabi/src/Unwind/Unwind-EHABI.cpp", a2, a3);
  abort();
}

//----- (000054B8) --------------------------------------------------------
int __fastcall sub_54B8(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // r4@0
  int v6; // r5@0
  int v7; // r6@0
  int v8; // r7@0
  int v9; // r8@0
  int v10; // r9@0
  int v11; // r10@0
  int v12; // r11@0
  int v13; // r12@0
  int v14; // lr@0

  *(_DWORD *)a1 = a1;
  *(_DWORD *)(a1 + 4) = a2;
  *(_DWORD *)(a1 + 8) = a3;
  *(_DWORD *)(a1 + 12) = a4;
  *(_DWORD *)(a1 + 16) = v5;
  *(_DWORD *)(a1 + 20) = v6;
  *(_DWORD *)(a1 + 24) = v7;
  *(_DWORD *)(a1 + 28) = v8;
  *(_DWORD *)(a1 + 32) = v9;
  *(_DWORD *)(a1 + 36) = v10;
  *(_DWORD *)(a1 + 40) = v11;
  *(_DWORD *)(a1 + 44) = v12;
  *(_DWORD *)(a1 + 48) = v13;
  *(_DWORD *)(a1 + 52) = &a5;
  *(_DWORD *)(a1 + 56) = v14;
  *(_DWORD *)(a1 + 60) = v14;
  return 0;
}

//----- (000054D0) --------------------------------------------------------
int __fastcall sub_54D0(int _R0)
{
  int result; // r0@1

  __asm { VSTMIA          R0, {D0-D15} }
  return result;
}

//----- (000054D8) --------------------------------------------------------
int __fastcall sub_54D8(int _R0)
{
  int result; // r0@1

  __asm { VSTMIA          R0, {D0-D15} }
  return result;
}

//----- (000054E0) --------------------------------------------------------
int __fastcall sub_54E0(int _R0)
{
  int result; // r0@1

  __asm { VSTMIA          R0, {D16-D31} }
  return result;
}

//----- (000054E8) --------------------------------------------------------
void sub_54E8()
{
  __asm
  {
    STCL            p1, c0, [R0],#8
    STCL            p1, c1, [R0],#8
    STCL            p1, c2, [R0],#8
    STCL            p1, c3, [R0],#8
    STCL            p1, c4, [R0],#8
    STCL            p1, c5, [R0],#8
    STCL            p1, c6, [R0],#8
    STCL            p1, c7, [R0],#8
    STCL            p1, c8, [R0],#8
    STCL            p1, c9, [R0],#8
    STCL            p1, c10, [R0],#8
    STCL            p1, c11, [R0],#8
    STCL            p1, c12, [R0],#8
    STCL            p1, c13, [R0],#8
    STCL            p1, c14, [R0],#8
    STCL            p1, c15, [R0],#8
  }
}

//----- (0000552C) --------------------------------------------------------
void sub_552C()
{
  __asm
  {
    STC2            p1, c8, [R0],#4
    STC2            p1, c9, [R0],#4
    STC2            p1, c10, [R0],#4
    STC2            p1, c11, [R0],#4
  }
}

//----- (00005540) --------------------------------------------------------
int __fastcall sub_5540(int a1)
{
  int v1; // r4@1

  v1 = a1;
  *(_DWORD *)a1 = &off_9D24;
  *(_DWORD *)(a1 + 4) = &unk_A014;
  *(_BYTE *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  _aeabi_memcpy(a1 + 8);
  _aeabi_memset(v1 + 80, 450, 0);
  sub_5AB4(v1, 0);
  return 0;
}
// 19D0: using guessed type int __fastcall _aeabi_memcpy(_DWORD);
// 19DC: using guessed type int __fastcall _aeabi_memset(_DWORD, _DWORD, _DWORD);
// 9D24: using guessed type void *;

//----- (00005590) --------------------------------------------------------
signed int __fastcall sub_5590(int a1, int a2, _DWORD *a3)
{
  int v3; // r6@1
  _DWORD *v4; // r4@1
  int v5; // r5@1
  signed int result; // r0@2

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (**)(void))(*(_DWORD *)a1 + 8))() == 1 )
  {
    *v4 = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 12))(v3, v5);
    result = 0;
  }
  else
  {
    result = -6542;
  }
  return result;
}

//----- (000055C0) --------------------------------------------------------
signed int __fastcall sub_55C0(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r6@1
  int v5; // r5@1
  signed int v6; // r5@3

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (**)(void))(*(_DWORD *)a1 + 8))() == 1 )
  {
    (*(void (__fastcall **)(int, int, int))(*(_DWORD *)v3 + 16))(v3, v5, v4);
    if ( v5 == -1 )
    {
      v6 = 0;
      (*(void (__fastcall **)(int, _DWORD))(*(_DWORD *)v3 + 52))(v3, 0);
    }
    else
    {
      v6 = 0;
    }
  }
  else
  {
    v6 = -6542;
  }
  return v6;
}

//----- (00005604) --------------------------------------------------------
signed int __fastcall sub_5604(int a1, int a2, _QWORD *a3)
{
  int v3; // r6@1
  _QWORD *v4; // r4@1
  int v5; // r5@1
  __int64 v6; // r0@2
  signed int result; // r0@2

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (**)(void))(*(_DWORD *)a1 + 20))() == 1 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 24))(v3, v5);
    *v4 = v6;
    result = 0;
  }
  else
  {
    result = -6542;
  }
  return result;
}

//----- (00005634) --------------------------------------------------------
signed int __fastcall sub_5634(int a1, int a2, int a3, int a4)
{
  int v4; // r7@1
  int v5; // r5@1
  int v6; // r6@1
  int v7; // r8@1
  signed int result; // r0@2

  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = a4;
  if ( (*(int (**)(void))(*(_DWORD *)a1 + 20))() == 1 )
  {
    (*(void (__fastcall **)(int, int, int, int))(*(_DWORD *)v4 + 28))(v4, v6, v5, v7);
    result = 0;
  }
  else
  {
    result = -6542;
  }
  return result;
}

//----- (0000566C) --------------------------------------------------------
int __fastcall sub_566C(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 32))();
}

//----- (00005674) --------------------------------------------------------
signed int __fastcall sub_5674(int a1, int a2)
{
  int v2; // r4@1
  signed int result; // r0@1

  v2 = a2;
  (*(void (**)(void))(*(_DWORD *)a1 + 36))();
  result = 0;
  if ( !*(_DWORD *)(v2 + 4) )
    result = -6549;
  return result;
}

//----- (00005694) --------------------------------------------------------
signed int __fastcall sub_5694(int a1)
{
  (*(void (**)(void))(*(_DWORD *)a1 + 40))();
  return -6540;
}

//----- (000056AC) --------------------------------------------------------
int __fastcall sub_56AC(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 60))();
}

//----- (000056BC) --------------------------------------------------------
int __fastcall sub_56BC(int a1, int a2)
{
  signed int v2; // r2@1
  bool v3; // zf@1
  signed int v4; // r0@1
  unsigned int v5; // r1@1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFFC) == 192;
  v4 = 0;
  v5 = a2 - 16;
  if ( v3 )
    v4 = 1;
  if ( v5 > 0xFFFFFFED )
    v2 = 1;
  return v4 | v2;
}

//----- (000056DC) --------------------------------------------------------
int __fastcall sub_56DC(int a1, signed int a2)
{
  signed int v2; // r5@1
  int v3; // r4@1
  int v4; // r0@7

  v2 = a2;
  v3 = a1;
  if ( a2 >= -1 )
  {
    if ( a2 > 13 )
    {
      if ( a2 == 14 )
      {
        v4 = a1 + 64;
        return *(_DWORD *)v4;
      }
      if ( a2 != 15 )
        goto LABEL_12;
    }
    else if ( a2 != -1 )
    {
      if ( a2 != 13 )
        goto LABEL_12;
LABEL_7:
      v4 = a1 + 60;
      return *(_DWORD *)v4;
    }
    v4 = a1 + 68;
    return *(_DWORD *)v4;
  }
  if ( a2 == -2 )
    goto LABEL_7;
LABEL_12:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_5B14(
        (int)"uint32_t libunwind::Registers_arm::getRegister(int)",
        (int)"external/libcxxabi/src/Unwind/Registers.hpp",
        1452,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(a1 + 76) )
    {
      *(_BYTE *)(a1 + 76) = 1;
      sub_552C();
    }
    v4 = v3 + 4 * v2 - 296;
  }
  else
  {
    v4 = a1 + 4 * a2 + 8;
  }
  return *(_DWORD *)v4;
}

//----- (00005778) --------------------------------------------------------
int __fastcall sub_5778(int result, signed int a2, int a3)
{
  signed int v3; // r6@1
  int v4; // r4@1
  int v5; // r5@1

  v3 = a2;
  v4 = a3;
  v5 = result;
  if ( a2 >= -1 )
  {
    if ( a2 > 13 )
    {
      if ( a2 == 14 )
      {
        *(_DWORD *)(result + 64) = a3;
        return result;
      }
      if ( a2 != 15 )
        goto LABEL_12;
    }
    else if ( a2 != -1 )
    {
      if ( a2 != 13 )
        goto LABEL_12;
LABEL_7:
      *(_DWORD *)(result + 60) = a3;
      return result;
    }
    *(_DWORD *)(result + 68) = a3;
    return result;
  }
  if ( a2 == -2 )
    goto LABEL_7;
LABEL_12:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_5B14(
        (int)"void libunwind::Registers_arm::setRegister(int, uint32_t)",
        (int)"external/libcxxabi/src/Unwind/Registers.hpp",
        1471,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(result + 76) )
    {
      *(_BYTE *)(result + 76) = 1;
      sub_552C();
    }
    result = v5 + 4 * v3;
    *(_DWORD *)(result - 296) = v4;
  }
  else
  {
    result += 4 * a2;
    *(_DWORD *)(result + 8) = a3;
  }
  return result;
}

//----- (00005810) --------------------------------------------------------
int __fastcall sub_5810(int a1, int a2)
{
  signed int v2; // r2@1
  bool v3; // zf@1
  signed int v4; // r0@1
  unsigned int v5; // r1@1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFF0) == 112;
  v4 = 0;
  v5 = a2 & 0xFFFFFFE0;
  if ( v3 )
    v4 = 1;
  if ( v5 == 256 )
    v2 = 1;
  return v4 | v2;
}

//----- (00005830) --------------------------------------------------------
__int64 __fastcall sub_5830(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  unsigned int v4; // r0@1
  int v5; // r0@5
  int v6; // r0@11

  v2 = a2;
  v3 = a1;
  v4 = a2 & 0xFFFFFFF0;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v3 + 75) )
    {
      *(_BYTE *)(v3 + 75) = 1;
      sub_54E8();
    }
    v5 = v3 + 8 * v2 - 552;
  }
  else if ( v4 == 272 )
  {
    if ( !*(_BYTE *)(v3 + 74) )
    {
      *(_BYTE *)(v3 + 74) = 1;
      sub_54E0(v3 + 216);
    }
    v5 = v3 + 8 * v2 - 1960;
  }
  else
  {
    if ( v4 != 256 )
      sub_5B14(
        (int)"unw_fpreg_t libunwind::Registers_arm::getFloatRegister(int)",
        (int)"external/libcxxabi/src/Unwind/Registers.hpp",
        1673,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v3 + 73) )
    {
      *(_BYTE *)(v3 + 73) = 1;
      v6 = v3 + 80;
      if ( *(_BYTE *)(v3 + 72) )
        sub_54D8(v6);
      else
        sub_54D0(v6);
    }
    v5 = v3 + 8 * v2 - 1968;
  }
  return *(_QWORD *)v5;
}

//----- (000058E0) --------------------------------------------------------
int __fastcall sub_58E0(int a1, int a2, int a3, int a4)
{
  int v4; // r6@1
  int v5; // r7@1
  unsigned int v6; // r0@1
  int v7; // r5@1
  int v8; // r4@1
  int result; // r0@5
  int v10; // r1@5
  int v11; // r0@11

  v4 = a2;
  v5 = a1;
  v6 = a2 & 0xFFFFFFF0;
  v7 = a4;
  v8 = a3;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v5 + 75) )
    {
      *(_BYTE *)(v5 + 75) = 1;
      sub_54E8();
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 548) = v7;
    LOWORD(v10) = -552;
  }
  else if ( v6 == 272 )
  {
    if ( !*(_BYTE *)(v5 + 74) )
    {
      *(_BYTE *)(v5 + 74) = 1;
      sub_54E0(v5 + 216);
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1828) = v7;
    LOWORD(v10) = -1832;
  }
  else
  {
    if ( v6 != 256 )
      sub_5B14(
        (int)"void libunwind::Registers_arm::setFloatRegister(int, unw_fpreg_t)",
        (int)"external/libcxxabi/src/Unwind/Registers.hpp",
        1700,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v5 + 73) )
    {
      *(_BYTE *)(v5 + 73) = 1;
      v11 = v5 + 80;
      if ( *(_BYTE *)(v5 + 72) )
        sub_54D8(v11);
      else
        sub_54D0(v11);
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1964) = v7;
    LOWORD(v10) = -1968;
  }
  HIWORD(v10) = -1;
  *(_DWORD *)(result + v10) = v8;
  return result;
}

//----- (000059B4) --------------------------------------------------------
signed int __fastcall sub_59B4(int a1)
{
  int v1; // r4@1
  signed int result; // r0@3
  void (__fastcall *v3)(int, signed int, int); // r5@5
  int v4; // r0@5

  v1 = a1;
  if ( *(_BYTE *)(a1 + 528)
    || ((*(void (__fastcall **)(int, signed int))(*(_DWORD *)a1 + 52))(a1, 1), *(_BYTE *)(v1 + 528)) )
  {
    result = 0;
  }
  else
  {
    if ( *(_DWORD *)(v1 + 504) )
    {
      v3 = *(void (__fastcall **)(int, signed int, int))(*(_DWORD *)v1 + 16);
      v4 = (*(int (__fastcall **)(int, signed int))(*(_DWORD *)v1 + 12))(v1, -2);
      v3(v1, -2, *(_DWORD *)(v1 + 504) + v4);
    }
    result = 1;
  }
  return result;
}

//----- (00005A00) --------------------------------------------------------
int __fastcall sub_5A00(int a1, int a2)
{
  int v2; // r12@1
  int v3; // lr@1
  int v4; // r11@1
  int v5; // r3@1
  int v6; // r4@1
  int v7; // r5@1
  int v8; // r4@1
  int v9; // r2@1
  int v10; // r3@1
  int v11; // r5@1
  int result; // r0@1

  v2 = *(_DWORD *)(a1 + 488);
  v3 = *(_DWORD *)(a1 + 492);
  v4 = a2 + 8;
  v5 = *(_DWORD *)(a1 + 500);
  v6 = *(_DWORD *)(a1 + 504);
  v7 = *(_DWORD *)(a1 + 508);
  *(_DWORD *)v4 = *(_DWORD *)(a1 + 496);
  *(_DWORD *)(v4 + 4) = v5;
  *(_DWORD *)(v4 + 8) = v6;
  *(_DWORD *)(v4 + 12) = v7;
  v8 = a2 + 24;
  *(_DWORD *)a2 = v2;
  *(_DWORD *)(a2 + 4) = v3;
  v9 = *(_DWORD *)(a1 + 512);
  v10 = *(_DWORD *)(a1 + 516);
  v11 = *(_DWORD *)(a1 + 520);
  result = *(_DWORD *)(a1 + 524);
  *(_DWORD *)(a2 + 36) = result;
  *(_DWORD *)v8 = v9;
  *(_DWORD *)(v8 + 4) = v10;
  *(_DWORD *)(v8 + 8) = v11;
  return result;
}

//----- (00005A38) --------------------------------------------------------
void __fastcall sub_5A38(int a1)
{
  sub_5B48(a1 + 8);
  sub_65A8();
}

//----- (00005A50) --------------------------------------------------------
int __fastcall sub_5A50(int a1)
{
  return *(_BYTE *)(a1 + 529);
}

//----- (00005A58) --------------------------------------------------------
signed int __fastcall sub_5A58(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // r6@1
  int v5; // r5@1
  _DWORD *v6; // r4@1
  int v7; // r7@1
  int v8; // r0@1
  bool v9; // zf@1
  signed int result; // r0@4
  int v11; // [sp+10h] [bp-20h]@2
  int v12; // [sp+14h] [bp-1Ch]@4

  v4 = a2;
  v5 = a3;
  v6 = a4;
  v7 = (*(int (**)(void))(*(_DWORD *)a1 + 12))();
  v8 = dladdr();
  v9 = v8 == 0;
  if ( v8 )
    v9 = v11 == 0;
  if ( v9 )
  {
    result = 0;
  }
  else
  {
    _snprintf_chk(v4, v5, 0, -1);
    *v6 = v7 - v12;
    result = 1;
  }
  return result;
}
// 19E8: using guessed type int dladdr(void);
// 19F4: using guessed type int __fastcall _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00005AB4) --------------------------------------------------------
int __fastcall sub_5AB4(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  unsigned int v4; // r5@1
  int v5; // r0@3
  bool v6; // zf@3
  int result; // r0@6
  int v8; // [sp+4h] [bp-1Ch]@3
  int v9; // [sp+8h] [bp-18h]@3
  int v10; // [sp+Ch] [bp-14h]@1

  v2 = a1;
  v3 = a2;
  v4 = (*(int (**)(void))(*(_DWORD *)a1 + 12))() & 0xFFFFFFFE;
  v10 = 0;
  if ( v3 )
    --v4;
  v5 = _gnu_Unwind_Find_exidx(v4, &v10);
  v6 = v5 == 0;
  v8 = v5;
  v9 = v10;
  if ( v5 )
    v6 = v10 == 0;
  if ( v6 || (result = ((int (__fastcall *)(int, unsigned int, int *))sub_5B9C)(v2, v4, &v8)) == 0 )
  {
    result = 1;
    *(_BYTE *)(v2 + 528) = 1;
  }
  return result;
}
// 1A00: using guessed type int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD);
// 5B9C: using guessed type int sub_5B9C();

//----- (00005B04) --------------------------------------------------------
const char *__fastcall sub_5B04(int a1, signed int a2)
{
  const char *result; // r0@2
  signed int v3; // r1@3
  int *v4; // r0@3

  if ( a2 > 255 )
  {
    switch ( a2 )
    {
      case 256:
        v3 = -9215;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 257:
        v3 = -9212;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 258:
        v3 = -9209;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 259:
        v3 = -9206;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 260:
        v3 = -9203;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 261:
        v3 = -9200;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 262:
        v3 = -9197;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 263:
        v3 = -9194;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 264:
        v3 = -9191;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 265:
        v3 = -9188;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 266:
        v3 = -9185;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 267:
        v3 = -9181;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 268:
        v3 = -9177;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 269:
        v3 = -9173;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 270:
        v3 = -9169;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 271:
        v3 = -9165;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 272:
        v3 = -9161;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 273:
        v3 = -9157;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 274:
        v3 = -9153;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 275:
        v3 = -9149;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 276:
        v3 = -9145;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 277:
        v3 = -9141;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 278:
        v3 = -9137;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 279:
        v3 = -9133;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 280:
        v3 = -9129;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 281:
        v3 = -9125;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 282:
        v3 = -9121;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 283:
        v3 = -9117;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 284:
        v3 = -9113;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 285:
        v3 = -9109;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 286:
        v3 = -9105;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 287:
        v3 = -9101;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      default:
def_5E70:
        v3 = -9097;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
    }
  }
  else
  {
    result = "pc";
    switch ( a2 + 2 )
    {
      case 0:
      case 15:
        v3 = -9378;
        v4 = &GLOBAL_OFFSET_TABLE_;
        return (char *)v4 + v3;
      default:
        goto def_5E70;
      case 1:
      case 17:
        return result;
      case 2:
        v3 = -9375;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 3:
        v3 = -9372;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 4:
        v3 = -9369;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 5:
        v3 = -9366;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 6:
        v3 = -9363;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 7:
        v3 = -9360;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 8:
        v3 = -9357;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 9:
        v3 = -9354;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 10:
        v3 = -9351;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 11:
        v3 = -9348;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 12:
        v3 = -9345;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 13:
        v3 = -9341;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 14:
        v3 = -9337;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 16:
        v3 = -9381;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 66:
        v3 = -9333;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 67:
        v3 = -9330;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 68:
        v3 = -9327;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 69:
        v3 = -9324;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 70:
        v3 = -9321;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 71:
        v3 = -9318;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 72:
        v3 = -9315;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 73:
        v3 = -9312;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 74:
        v3 = -9309;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 75:
        v3 = -9306;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 76:
        v3 = -9303;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 77:
        v3 = -9299;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 78:
        v3 = -9295;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 79:
        v3 = -9291;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 80:
        v3 = -9287;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 81:
        v3 = -9283;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 82:
        v3 = -9279;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 83:
        v3 = -9275;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 84:
        v3 = -9271;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 85:
        v3 = -9267;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 86:
        v3 = -9263;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 87:
        v3 = -9259;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 88:
        v3 = -9255;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 89:
        v3 = -9251;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 90:
        v3 = -9247;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 91:
        v3 = -9243;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 92:
        v3 = -9239;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 93:
        v3 = -9235;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 94:
        v3 = -9231;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 95:
        v3 = -9227;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 96:
        v3 = -9223;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
      case 97:
        v3 = -9219;
        v4 = &GLOBAL_OFFSET_TABLE_;
        break;
    }
  }
  return (char *)v4 + v3;
}
// 9EAC: using guessed type int GLOBAL_OFFSET_TABLE_;

//----- (00005B0C) --------------------------------------------------------
int __fastcall sub_5B0C(int result)
{
  *(_BYTE *)(result + 72) = 1;
  return result;
}

//----- (00005B14) --------------------------------------------------------
void __fastcall sub_5B14(int a1, int a2, int a3, int a4)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, a2, a3, a4);
  abort();
}

//----- (00005B48) --------------------------------------------------------
int __fastcall sub_5B48(int a1)
{
  int v1; // r4@1
  int v2; // r0@2
  int result; // r0@9

  v1 = a1;
  if ( *(_BYTE *)(a1 + 65) )
  {
    v2 = a1 + 72;
    if ( *(_BYTE *)(v1 + 64) )
      sub_6414(v2);
    else
      sub_640C(v2);
  }
  if ( *(_BYTE *)(v1 + 66) )
    sub_641C(v1 + 208);
  if ( *(_BYTE *)(v1 + 67) )
    sub_6424((_DWORD *)(v1 + 336));
  result = *(_BYTE *)(v1 + 68);
  if ( *(_BYTE *)(v1 + 68) )
    result = sub_65B8((_DWORD *)(v1 + 464));
  return result;
}

//----- (00005D24) --------------------------------------------------------
int __fastcall sub_5D24(int result, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8)
{
  unsigned int v8; // r4@1
  unsigned int v9; // r5@2
  int v10; // r6@3

  v8 = a5 - a2;
  while ( 1 )
  {
    v9 = v8;
    if ( !v8 )
      break;
    v10 = a2 + (v8 >> 1);
    v8 >>= 1;
    if ( *a8 >= *a4 + 8 * v10 + (2 * *(_DWORD *)(*a4 + 8 * v10) & 0x80000000 | *(_DWORD *)(*a4 + 8 * v10)) )
    {
      v8 = v9 - 1 - v8;
      a2 = v10 + 1;
    }
  }
  *(_DWORD *)result = a2;
  *(_DWORD *)(result + 4) = a3;
  *(_DWORD *)(result + 8) = a4;
  return result;
}

//----- (0000640C) --------------------------------------------------------
int __fastcall sub_640C(int _R0)
{
  int result; // r0@1

  __asm { VLDMIA          R0, {D0-D15} }
  return result;
}

//----- (00006414) --------------------------------------------------------
int __fastcall sub_6414(int _R0)
{
  int result; // r0@1

  __asm { VLDMIA          R0, {D0-D15} }
  return result;
}

//----- (0000641C) --------------------------------------------------------
int __fastcall sub_641C(int _R0)
{
  int result; // r0@1

  __asm { VLDMIA          R0, {D16-D31} }
  return result;
}

//----- (00006424) --------------------------------------------------------
int __fastcall sub_6424(_DWORD *a1)
{
  int *v5; // r0@1
  int result; // r0@1

  _T1 = *a1;
  v5 = a1 + 2;
  __asm { LDCL            p1, c0, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c1, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c2, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c3, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c4, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c5, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c6, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c7, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c8, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c9, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c10, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c11, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c12, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c13, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c14, [R0],#8 }
  _T1 = *v5;
  result = (int)(v5 + 2);
  __asm { LDCL            p1, c15, [R0],#8 }
  return result;
}

//----- (00006468) --------------------------------------------------------
int __fastcall sub_6468(_DWORD *a1)
{
  int *v5; // r0@1
  int result; // r0@1

  _T1 = *a1;
  v5 = a1 + 1;
  __asm { LDC2            p1, c8, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c9, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c10, [R0],#4 }
  _T1 = *v5;
  result = (int)(v5 + 1);
  __asm { LDC2            p1, c11, [R0],#4 }
  return result;
}

//----- (00006484) --------------------------------------------------------
int __fastcall sub_6484(int result, unsigned int a2)
{
  char v2; // nf@0
  int v3; // r12@1
  unsigned int v4; // r3@4
  char v5; // r0@8
  unsigned int v6; // r1@8
  unsigned int v7; // r2@8
  bool v8; // zf@17

  v3 = result ^ a2;
  if ( v2 )
    a2 = -a2;
  if ( a2 == 1 )
  {
    if ( (v3 ^ result) < 0 )
      result = -result;
  }
  else
  {
    v4 = result;
    if ( result < 0 )
      v4 = -result;
    if ( v4 <= a2 )
    {
      if ( v4 < a2 )
        result = 0;
      if ( v4 == a2 )
        result = (v3 >> 31) | 1;
    }
    else if ( a2 & (a2 - 1) )
    {
      v5 = __clz(a2) - __clz(v4);
      v6 = a2 << v5;
      v7 = 1 << v5;
      result = 0;
      while ( 1 )
      {
        if ( v4 >= v6 )
        {
          v4 -= v6;
          result |= v7;
        }
        if ( v4 >= v6 >> 1 )
        {
          v4 -= v6 >> 1;
          result |= v7 >> 1;
        }
        if ( v4 >= v6 >> 2 )
        {
          v4 -= v6 >> 2;
          result |= v7 >> 2;
        }
        if ( v4 >= v6 >> 3 )
        {
          v4 -= v6 >> 3;
          result |= v7 >> 3;
        }
        v8 = v4 == 0;
        if ( v4 )
        {
          v7 >>= 4;
          v8 = v7 == 0;
        }
        if ( v8 )
          break;
        v6 >>= 4;
      }
      if ( v3 < 0 )
        result = -result;
    }
    else
    {
      result = v4 >> (31 - __clz(a2));
      if ( v3 < 0 )
        result = -result;
    }
  }
  return result;
}

//----- (00006578) --------------------------------------------------------
int _aeabi_ldiv0()
{
  return raise(8);
}

//----- (00006588) --------------------------------------------------------
int j_j_pthread_mutex_unlock(pthread_mutex_t *mutex)
{
  return j_pthread_mutex_unlock(mutex);
}

//----- (0000658C) --------------------------------------------------------
int j_pthread_mutex_unlock(pthread_mutex_t *mutex)
{
  return pthread_mutex_unlock(mutex);
}

//----- (00006598) --------------------------------------------------------
int __fastcall j_j_j_mm_jpeg_destroy_session(int a1, int a2)
{
  return j_j_mm_jpeg_destroy_session(a1, a2);
}

//----- (0000659C) --------------------------------------------------------
int __fastcall j_j_mm_jpeg_destroy_session(int a1, int a2)
{
  return j_mm_jpeg_destroy_session(a1, a2);
}

//----- (000065A8) --------------------------------------------------------
void sub_65A8()
{
  sub_65AC();
}

//----- (000065AC) --------------------------------------------------------
void sub_65AC()
{
  JUMPOUT(sub_63F8);
}
// 63F8: using guessed type int sub_63F8();

//----- (000065B8) --------------------------------------------------------
int __fastcall sub_65B8(_DWORD *a1)
{
  return sub_65BC(a1);
}

//----- (000065BC) --------------------------------------------------------
int __fastcall sub_65BC(_DWORD *a1)
{
  return sub_6468(a1);
}

// ALL OK, 164 function(s) have been successfully decompiled
